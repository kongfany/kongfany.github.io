<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>个性化联邦 - 乐观积极的...</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="kong" /><meta name="description" content="视频 code fedbn ditto fedala fedb 数据集处理 dataset等三个文件夹mark directory as sources root&amp;ndash;import下列的文件时才可以识别到 system ​ flscore" /><meta name="keywords" content="Hugo, theme, even" />






<meta name="generator" content="Hugo 0.87.0 with theme even" />


<link rel="canonical" href="https://kongfany.github.io/post/fl_pfl2/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.b5a744db6de49a86cadafb3b70f555ab443f83c307a483402259e94726b045ff.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="个性化联邦" />
<meta property="og:description" content="视频 code fedbn ditto fedala fedb 数据集处理 dataset等三个文件夹mark directory as sources root&ndash;import下列的文件时才可以识别到 system ​ flscore" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://kongfany.github.io/post/fl_pfl2/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2023-11-28T15:25:56+08:00" />
<meta property="article:modified_time" content="2023-11-28T15:25:56+08:00" />

<meta itemprop="name" content="个性化联邦">
<meta itemprop="description" content="视频 code fedbn ditto fedala fedb 数据集处理 dataset等三个文件夹mark directory as sources root&ndash;import下列的文件时才可以识别到 system ​ flscore"><meta itemprop="datePublished" content="2023-11-28T15:25:56+08:00" />
<meta itemprop="dateModified" content="2023-11-28T15:25:56+08:00" />
<meta itemprop="wordCount" content="7743">
<meta itemprop="keywords" content="Federated Learning," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="个性化联邦"/>
<meta name="twitter:description" content="视频 code fedbn ditto fedala fedb 数据集处理 dataset等三个文件夹mark directory as sources root&ndash;import下列的文件时才可以识别到 system ​ flscore"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">乐观积极的...</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">乐观积极的...</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">个性化联邦</h1>

      <div class="post-meta">
        <span class="post-time"> 2023-11-28 </span>
        
          <span class="more-meta"> 7743 words </span>
          <span class="more-meta"> 16 mins read </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content always-active">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#数据集处理">数据集处理</a></li>
        <li><a href="#client处理">client处理</a></li>
        <li><a href="#fadala">FadALA</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <blockquote>
<p><a href="https://www.bilibili.com/video/BV1bu411K7bV/?spm_id_from=333.999.0.0&amp;vd_source=ad42090d7d6fcdfc144126ae0e2884ac">视频</a></p>
<p><a href="https://github.com/TsingZ0/PFL-Non-IID">code</a></p>
<p>fedbn</p>
<p>ditto</p>
<p><a href="https://mp.weixin.qq.com/s/ILkTq38FTXOnQ4tZ8nx6Fw">fedala</a></p>
<p>fedb</p>
</blockquote>
<h2 id="数据集处理">数据集处理</h2>
<p>dataset等三个文件夹mark directory as sources root&ndash;import下列的文件时才可以识别到</p>
<p>system</p>
<p>​	flscore：</p>
<p>​		client</p>
<p>​		server</p>
<p>​		optimizers</p>
<p>​	until：</p>
<p>generate_mnist.py：生成数据集mnist在dirpath下</p>
<p>rawdata：原始数据集60000trian10000test</p>
<p>test、train：20个npz文件</p>
<p>jason串格式化<code>ctrl+alt+l</code>(所有代码格式化都可用，和网易云冲突但是)</p>
<hr>
<blockquote>
<p>For the <em><strong>label skew</strong></em> scenario ：标签偏移</p>
<p>In <strong>non-IID</strong> scenario, 2 situations exist. The first one is the <strong>pathological non-IID</strong> scenario, the second one is <strong>practical non-IID</strong> scenario.</p>
<p>第一种是病理性非 IID 场景，第二种是实际的非 IID 场景。例如，在病理性非 IID 场景中，每个客户机上的数据只包含特定数量的标签(可能只有2个标签) ，尽管所有客户机上的数据包含10个标签，比如 MNIST 数据集。在实际的非内部 ID 场景中，使用了狄利克雷分布。</p>
</blockquote>
<blockquote>
<p>划分数据的不同场景</p>
<p>1、python generate_mnist.py iid balance - # for iid and balanced scenario</p>
<p>IID，平衡&ndash;每个client包含所有类，且每个client分到的当前类的样本数相同</p>
<p>2、python generate_mnist.py iid - - # for iid and unbalanced scenario</p>
<p>IID,不平衡场景&ndash;每个client包含所有类，但数据量当前类对应的</p>
<p>3、python generate_mnist.py noniid - pat # for pathological noniid and unbalanced scenario</p>
<p>4、python generate_mnist.py noniid - dir # for practical noniid and unbalanced scenario</p>
</blockquote>
<p>“balance” 通常表示在训练过程中平衡各个参与方（如客户端）的贡献或资源分配。这可以包括确保每个参与方有足够的训练样本、计算资源或者对模型更新的贡献，以实现公平性和效率性。</p>
<p>联邦学习的不平衡场景可能包括以下情况： 1. 数据分布不均：参与方（如客户端）拥有的数据量差异很大，有些参与方拥有的样本数量非常少，而有些参与方拥有的样本数量非常多。 2. 计算资源不均：参与方的计算能力不同，有些参与方的设备性能较低，而有些参与方的设备性能较高。 3. 数据标签不均：在分类任务中，不同类别的样本数量差异很大，导致一些类别的数据在训练过程中被较少地考虑。 这些不平衡的场景可能会对联邦学习的模型训练和整体性能产生影响，需要采取相应的策略来解决。</p>
<p>1、iid and balanced scenario：将每个类(10)划分到所有客户端，将当前类对应的数据平均分给每个client(20)</p>
<p>2、iid and unbalanced scenario：</p>
<hr>
<p>下载数据，将数据的训练集测试集揉在一起，然后划分到每个client，然后分为训练集和测试集。然后将划分的参数和每个client的数据情况保存到jason串中。</p>
<p>pfl每个client都有测试集，揉和后划分之后再区分&ndash;保证客户端的训练集和测试集的分布一致，有利于pfl的准确率</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span><span class="lnt">183
</span><span class="lnt">184
</span><span class="lnt">185
</span><span class="lnt">186
</span><span class="lnt">187
</span><span class="lnt">188
</span><span class="lnt">189
</span><span class="lnt">190
</span><span class="lnt">191
</span><span class="lnt">192
</span><span class="lnt">193
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="c1"># idxs:7000个数据对应的下标数组</span>
<span class="p">(</span><span class="n">Pdb</span><span class="p">)</span> <span class="n">p</span> <span class="n">idxs</span>
<span class="n">array</span><span class="p">([</span>    <span class="mi">0</span><span class="p">,</span>     <span class="mi">1</span><span class="p">,</span>     <span class="mi">2</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">69997</span><span class="p">,</span> <span class="mi">69998</span><span class="p">,</span> <span class="mi">69999</span><span class="p">])</span>
<span class="p">(</span><span class="n">Pdb</span><span class="p">)</span> <span class="n">p</span> <span class="nb">len</span><span class="p">(</span><span class="n">idxs</span><span class="p">)</span>
<span class="mi">70000</span>

<span class="c1"># idx_for_each_class 对应了数据的每个类别的下标</span>
<span class="p">(</span><span class="n">Pdb</span><span class="p">)</span> <span class="n">p</span> <span class="n">idx_for_each_class</span>
<span class="p">[</span><span class="n">array</span><span class="p">([</span>    <span class="mi">1</span><span class="p">,</span>    <span class="mi">21</span><span class="p">,</span>    <span class="mi">34</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">69964</span><span class="p">,</span> <span class="mi">69983</span><span class="p">,</span> <span class="mi">69993</span><span class="p">]),</span> <span class="n">array</span><span class="p">([</span>    <span class="mi">3</span><span class="p">,</span>     <span class="mi">6</span><span class="p">,</span>     <span class="mi">8</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">69978</span><span class="p">,</span> <span class="mi">69984</span><span class="p">,</span> <span class="mi">69994</span><span class="p">]),</span> <span class="n">array</span><span class="p">([</span>    <span class="mi">5</span><span class="p">,</span>    <span class="mi">16</span><span class="p">,</span>    <span class="mi">25</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">69980</span><span class="p">,</span> <span class="mi">69985</span><span class="p">,</span> <span class="mi">69995</span><span class="p">]),</span> <span class="n">array</span><span class="p">([</span>    <span class="mi">7</span><span class="p">,</span>
  <span class="mi">10</span><span class="p">,</span>    <span class="mi">12</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">69975</span><span class="p">,</span> <span class="mi">69986</span><span class="p">,</span> <span class="mi">69996</span><span class="p">]),</span> <span class="n">array</span><span class="p">([</span>    <span class="mi">2</span><span class="p">,</span>     <span class="mi">9</span><span class="p">,</span>    <span class="mi">20</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">69977</span><span class="p">,</span> <span class="mi">69987</span><span class="p">,</span> <span class="mi">69997</span><span class="p">]),</span> <span class="n">array</span><span class="p">([</span>    <span class="mi">0</span><span class="p">,</span>    <span class="mi">11</span><span class="p">,</span>    <span class="mi">35</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">69982</span><span class="p">,</span> <span class="mi">69988</span><span class="p">,</span> <span class="mi">69998</span><span class="p">]),</span> <span class="n">array</span><span class="p">([</span>   <span class="mi">13</span><span class="p">,</span>    <span class="mi">18</span><span class="p">,</span>    <span class="mi">32</span><span class="p">,</span> <span class="o">...</span>
<span class="p">,</span> <span class="mi">69981</span><span class="p">,</span> <span class="mi">69989</span><span class="p">,</span> <span class="mi">69999</span><span class="p">]),</span> <span class="n">array</span><span class="p">([</span>   <span class="mi">15</span><span class="p">,</span>    <span class="mi">29</span><span class="p">,</span>    <span class="mi">38</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">69968</span><span class="p">,</span> <span class="mi">69979</span><span class="p">,</span> <span class="mi">69990</span><span class="p">]),</span> <span class="n">array</span><span class="p">([</span>   <span class="mi">17</span><span class="p">,</span>    <span class="mi">31</span><span class="p">,</span>    <span class="mi">41</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">69959</span><span class="p">,</span> <span class="mi">69967</span><span class="p">,</span> <span class="mi">69991</span><span class="p">]),</span> <span class="n">array</span><span class="p">([</span>    <span class="mi">4</span><span class="p">,</span>    <span class="mi">19</span><span class="p">,</span>    <span class="mi">22</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">69945</span><span class="p">,</span> <span class="mi">69973</span><span class="p">,</span>
<span class="mi">69992</span><span class="p">])]</span>
<span class="p">(</span><span class="n">Pdb</span><span class="p">)</span> <span class="n">p</span> <span class="nb">len</span><span class="p">(</span><span class="n">idx_for_each_class</span><span class="p">)</span>
<span class="mi">10</span>
<span class="c1"># 每个client的种类数量--平衡都是10，不平衡默认2</span>
<span class="p">(</span><span class="n">Pdb</span><span class="p">)</span> <span class="n">p</span> <span class="n">class_num_per_client</span>
<span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="c1"># 对于每一个class类别i，选择应该划分该类别的client</span>
<span class="c1"># 选取client的比例＝客户端种类的采样比例，不平衡len=2，选两个客户端</span>
<span class="p">(</span><span class="n">Pdb</span><span class="p">)</span> <span class="n">p</span> <span class="n">selected_clients</span>
<span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">19</span><span class="p">]</span>
<span class="c1"># 类别i的图片数量</span>
<span class="p">(</span><span class="n">Pdb</span><span class="p">)</span> <span class="n">p</span> <span class="n">num_all_samples</span>
<span class="mi">6903</span>
<span class="c1"># 类别i被划分的客户端数目</span>
<span class="p">(</span><span class="n">Pdb</span><span class="p">)</span> <span class="n">p</span> <span class="n">num_selected_clients</span>
<span class="mi">20</span>
<span class="c1"># 每个类别被分到的类别i对应的数量</span>
<span class="p">(</span><span class="n">Pdb</span><span class="p">)</span> <span class="n">p</span> <span class="n">num_per</span>
<span class="mf">345.15</span>
<span class="c1"># 每个客户端对应类别i的图片数量，前n-1个取整num_per,剩余的图片全放在第n个client</span>
<span class="c1"># 不平衡的话，以num_per为中间值高斯分布</span>
<span class="p">(</span><span class="n">Pdb</span><span class="p">)</span> <span class="n">p</span> <span class="n">num_samples</span>
<span class="p">[</span><span class="mi">345</span><span class="p">,</span> <span class="mi">345</span><span class="p">,</span> <span class="mi">345</span><span class="p">,</span> <span class="mi">345</span><span class="p">,</span> <span class="mi">345</span><span class="p">,</span> <span class="mi">345</span><span class="p">,</span> <span class="mi">345</span><span class="p">,</span> <span class="mi">345</span><span class="p">,</span> <span class="mi">345</span><span class="p">,</span> <span class="mi">345</span><span class="p">,</span> <span class="mi">345</span><span class="p">,</span> <span class="mi">345</span><span class="p">,</span> <span class="mi">345</span><span class="p">,</span> <span class="mi">345</span><span class="p">,</span> <span class="mi">345</span><span class="p">,</span> <span class="mi">345</span><span class="p">,</span> <span class="mi">345</span><span class="p">,</span> <span class="mi">345</span><span class="p">,</span> <span class="mi">345</span><span class="p">,</span> <span class="mi">348</span><span class="p">]</span>

<span class="c1"># 对于当前class，每个client分到的数据下标</span>
<span class="p">(</span><span class="n">Pdb</span><span class="p">)</span> <span class="n">p</span> <span class="n">dataidx_map</span>
<span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span>   <span class="mi">1</span><span class="p">,</span>   <span class="mi">21</span><span class="p">,</span>   <span class="mi">34</span><span class="p">,</span>   <span class="mi">37</span><span class="p">,</span>   <span class="mi">51</span><span class="p">,</span>   <span class="mi">56</span><span class="p">,</span>   <span class="mi">63</span><span class="p">,</span>   <span class="mi">68</span><span class="p">,</span>   <span class="mi">69</span><span class="p">,</span>   <span class="mi">75</span><span class="p">,</span>   <span class="mi">81</span><span class="p">,</span>
         <span class="mi">88</span><span class="p">,</span>   <span class="mi">95</span><span class="p">,</span>  <span class="mi">108</span><span class="p">,</span>  <span class="mi">114</span><span class="p">,</span>  <span class="mi">118</span><span class="p">,</span>  <span class="mi">119</span><span class="p">,</span>  <span class="mi">121</span><span class="p">,</span>  <span class="mi">156</span><span class="p">,</span>  <span class="mi">169</span><span class="p">,</span>  <span class="mi">192</span><span class="p">,</span>  <span class="mi">206</span><span class="p">,</span>
        <span class="mi">209</span><span class="p">,</span>  <span class="mi">210</span><span class="p">,</span>  <span class="mi">216</span><span class="p">,</span>  <span class="mi">229</span><span class="p">,</span>  <span class="mi">232</span><span class="p">,</span>  <span class="mi">234</span><span class="p">,</span>  <span class="mi">246</span><span class="p">,</span>  <span class="mi">249</span><span class="p">,</span>  <span class="mi">260</span><span class="p">,</span>  <span class="mi">283</span><span class="p">,</span>  <span class="mi">293</span><span class="p">,</span>
        <span class="mi">296</span><span class="p">,</span>  <span class="mi">303</span><span class="p">,</span>  <span class="mi">320</span><span class="p">,</span>  <span class="mi">326</span><span class="p">,</span>  <span class="mi">359</span><span class="p">,</span>  <span class="mi">399</span><span class="p">,</span>  <span class="mi">427</span><span class="p">,</span>  <span class="mi">429</span><span class="p">,</span>  <span class="mi">435</span><span class="p">,</span>  <span class="mi">440</span><span class="p">,</span>  <span class="mi">451</span><span class="p">,</span>
        <span class="mi">453</span><span class="p">,</span>  <span class="mi">458</span><span class="p">,</span>  <span class="mi">462</span><span class="p">,</span>  <span class="mi">464</span><span class="p">,</span>  <span class="mi">473</span><span class="p">,</span>  <span class="mi">489</span><span class="p">,</span>  <span class="mi">519</span><span class="p">,</span>  <span class="mi">524</span><span class="p">,</span>  <span class="mi">526</span><span class="p">,</span>  <span class="mi">527</span><span class="p">,</span>  <span class="mi">542</span><span class="p">,</span>
        <span class="mi">577</span><span class="p">,</span>  <span class="mi">582</span><span class="p">,</span>  <span class="mi">596</span><span class="p">,</span>  <span class="mi">603</span><span class="p">,</span>  <span class="mi">612</span><span class="p">,</span>  <span class="mi">633</span><span class="p">,</span>  <span class="mi">639</span><span class="p">,</span>  <span class="mi">656</span><span class="p">,</span>  <span class="mi">662</span><span class="p">,</span>  <span class="mi">666</span><span class="p">,</span>  <span class="mi">667</span><span class="p">,</span>
        <span class="mi">668</span><span class="p">,</span>  <span class="mi">669</span><span class="p">,</span>  <span class="mi">689</span><span class="p">,</span>  <span class="mi">702</span><span class="p">,</span>  <span class="mi">709</span><span class="p">,</span>  <span class="mi">712</span><span class="p">,</span>  <span class="mi">733</span><span class="p">,</span>  <span class="mi">743</span><span class="p">,</span>  <span class="mi">745</span><span class="p">,</span>  <span class="mi">776</span><span class="p">,</span>  <span class="mi">781</span><span class="p">,</span>
        <span class="mi">787</span><span class="p">,</span>  <span class="mi">790</span><span class="p">,</span>  <span class="mi">818</span><span class="p">,</span>  <span class="mi">825</span><span class="p">,</span>  <span class="mi">849</span><span class="p">,</span>  <span class="mi">859</span><span class="p">,</span>  <span class="mi">860</span><span class="p">,</span>  <span class="mi">869</span><span class="p">,</span>  <span class="mi">872</span><span class="p">,</span>  <span class="mi">889</span><span class="p">,</span>  <span class="mi">903</span><span class="p">,</span>
        <span class="mi">927</span><span class="p">,</span>  <span class="mi">943</span><span class="p">,</span>  <span class="mi">949</span><span class="p">,</span>  <span class="mi">952</span><span class="p">,</span>  <span class="mi">957</span><span class="p">,</span>  <span class="mi">965</span><span class="p">,</span>  <span class="mi">979</span><span class="p">,</span>  <span class="mi">984</span><span class="p">,</span>  <span class="mi">997</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">1015</span><span class="p">,</span>
       <span class="mi">1018</span><span class="p">,</span> <span class="mi">1028</span><span class="p">,</span> <span class="mi">1029</span><span class="p">,</span> <span class="mi">1040</span><span class="p">,</span> <span class="mi">1046</span><span class="p">,</span> <span class="mi">1049</span><span class="p">,</span> <span class="mi">1076</span><span class="p">,</span> <span class="mi">1078</span><span class="p">,</span> <span class="mi">1090</span><span class="p">,</span> <span class="mi">1093</span><span class="p">,</span> <span class="mi">1102</span><span class="p">,</span>
       <span class="mi">1107</span><span class="p">,</span> <span class="mi">1128</span><span class="p">,</span> <span class="mi">1137</span><span class="p">,</span> <span class="mi">1152</span><span class="p">,</span> <span class="mi">1168</span><span class="p">,</span> <span class="mi">1179</span><span class="p">,</span> <span class="mi">1195</span><span class="p">,</span> <span class="mi">1209</span><span class="p">,</span> <span class="mi">1268</span><span class="p">,</span> <span class="mi">1304</span><span class="p">,</span> <span class="mi">1310</span><span class="p">,</span>
       <span class="mi">1346</span><span class="p">,</span> <span class="mi">1349</span><span class="p">,</span> <span class="mi">1359</span><span class="p">,</span> <span class="mi">1363</span><span class="p">,</span> <span class="mi">1367</span><span class="p">,</span> <span class="mi">1368</span><span class="p">,</span> <span class="mi">1371</span><span class="p">,</span> <span class="mi">1372</span><span class="p">,</span> <span class="mi">1377</span><span class="p">,</span> <span class="mi">1386</span><span class="p">,</span> <span class="mi">1387</span><span class="p">,</span>
       <span class="mi">1403</span><span class="p">,</span> <span class="mi">1423</span><span class="p">,</span> <span class="mi">1443</span><span class="p">,</span> <span class="mi">1454</span><span class="p">,</span> <span class="mi">1471</span><span class="p">,</span> <span class="mi">1479</span><span class="p">,</span> <span class="mi">1489</span><span class="p">,</span> <span class="mi">1495</span><span class="p">,</span> <span class="mi">1501</span><span class="p">,</span> <span class="mi">1502</span><span class="p">,</span> <span class="mi">1512</span><span class="p">,</span>
       <span class="mi">1517</span><span class="p">,</span> <span class="mi">1530</span><span class="p">,</span> <span class="mi">1532</span><span class="p">,</span> <span class="mi">1571</span><span class="p">,</span> <span class="mi">1578</span><span class="p">,</span> <span class="mi">1590</span><span class="p">,</span> <span class="mi">1596</span><span class="p">,</span> <span class="mi">1600</span><span class="p">,</span> <span class="mi">1605</span><span class="p">,</span> <span class="mi">1606</span><span class="p">,</span> <span class="mi">1625</span><span class="p">,</span>
       <span class="mi">1626</span><span class="p">,</span> <span class="mi">1645</span><span class="p">,</span> <span class="mi">1664</span><span class="p">,</span> <span class="mi">1678</span><span class="p">,</span> <span class="mi">1682</span><span class="p">,</span> <span class="mi">1701</span><span class="p">,</span> <span class="mi">1709</span><span class="p">,</span> <span class="mi">1712</span><span class="p">,</span> <span class="mi">1723</span><span class="p">,</span> <span class="mi">1725</span><span class="p">,</span> <span class="mi">1729</span><span class="p">,</span>
       <span class="mi">1742</span><span class="p">,</span> <span class="mi">1769</span><span class="p">,</span> <span class="mi">1771</span><span class="p">,</span> <span class="mi">1775</span><span class="p">,</span> <span class="mi">1796</span><span class="p">,</span> <span class="mi">1797</span><span class="p">,</span> <span class="mi">1798</span><span class="p">,</span> <span class="mi">1819</span><span class="p">,</span> <span class="mi">1828</span><span class="p">,</span> <span class="mi">1837</span><span class="p">,</span> <span class="mi">1857</span><span class="p">,</span>
       <span class="mi">1868</span><span class="p">,</span> <span class="mi">1876</span><span class="p">,</span> <span class="mi">1877</span><span class="p">,</span> <span class="mi">1897</span><span class="p">,</span> <span class="mi">1904</span><span class="p">,</span> <span class="mi">1907</span><span class="p">,</span> <span class="mi">1916</span><span class="p">,</span> <span class="mi">1926</span><span class="p">,</span> <span class="mi">1927</span><span class="p">,</span> <span class="mi">1930</span><span class="p">,</span> <span class="mi">1956</span><span class="p">,</span>
       <span class="mi">1963</span><span class="p">,</span> <span class="mi">1969</span><span class="p">,</span> <span class="mi">1995</span><span class="p">,</span> <span class="mi">1999</span><span class="p">,</span> <span class="mi">2009</span><span class="p">,</span> <span class="mi">2051</span><span class="p">,</span> <span class="mi">2058</span><span class="p">,</span> <span class="mi">2066</span><span class="p">,</span> <span class="mi">2079</span><span class="p">,</span> <span class="mi">2081</span><span class="p">,</span> <span class="mi">2082</span><span class="p">,</span>
       <span class="mi">2084</span><span class="p">,</span> <span class="mi">2100</span><span class="p">,</span> <span class="mi">2101</span><span class="p">,</span> <span class="mi">2112</span><span class="p">,</span> <span class="mi">2121</span><span class="p">,</span> <span class="mi">2144</span><span class="p">,</span> <span class="mi">2147</span><span class="p">,</span> <span class="mi">2160</span><span class="p">,</span> <span class="mi">2191</span><span class="p">,</span> <span class="mi">2192</span><span class="p">,</span> <span class="mi">2195</span><span class="p">,</span>
       <span class="mi">2218</span><span class="p">,</span> <span class="mi">2245</span><span class="p">,</span> <span class="mi">2253</span><span class="p">,</span> <span class="mi">2257</span><span class="p">,</span> <span class="mi">2269</span><span class="p">,</span> <span class="mi">2278</span><span class="p">,</span> <span class="mi">2298</span><span class="p">,</span> <span class="mi">2310</span><span class="p">,</span> <span class="mi">2325</span><span class="p">,</span> <span class="mi">2327</span><span class="p">,</span> <span class="mi">2333</span><span class="p">,</span>
       <span class="mi">2340</span><span class="p">,</span> <span class="mi">2352</span><span class="p">,</span> <span class="mi">2353</span><span class="p">,</span> <span class="mi">2373</span><span class="p">,</span> <span class="mi">2396</span><span class="p">,</span> <span class="mi">2403</span><span class="p">,</span> <span class="mi">2404</span><span class="p">,</span> <span class="mi">2411</span><span class="p">,</span> <span class="mi">2435</span><span class="p">,</span> <span class="mi">2436</span><span class="p">,</span> <span class="mi">2440</span><span class="p">,</span>
       <span class="mi">2473</span><span class="p">,</span> <span class="mi">2483</span><span class="p">,</span> <span class="mi">2493</span><span class="p">,</span> <span class="mi">2500</span><span class="p">,</span> <span class="mi">2525</span><span class="p">,</span> <span class="mi">2526</span><span class="p">,</span> <span class="mi">2528</span><span class="p">,</span> <span class="mi">2532</span><span class="p">,</span> <span class="mi">2538</span><span class="p">,</span> <span class="mi">2539</span><span class="p">,</span> <span class="mi">2557</span><span class="p">,</span>
       <span class="mi">2561</span><span class="p">,</span> <span class="mi">2581</span><span class="p">,</span> <span class="mi">2582</span><span class="p">,</span> <span class="mi">2584</span><span class="p">,</span> <span class="mi">2586</span><span class="p">,</span> <span class="mi">2597</span><span class="p">,</span> <span class="mi">2606</span><span class="p">,</span> <span class="mi">2615</span><span class="p">,</span> <span class="mi">2617</span><span class="p">,</span> <span class="mi">2621</span><span class="p">,</span> <span class="mi">2624</span><span class="p">,</span>
       <span class="mi">2629</span><span class="p">,</span> <span class="mi">2642</span><span class="p">,</span> <span class="mi">2709</span><span class="p">,</span> <span class="mi">2718</span><span class="p">,</span> <span class="mi">2729</span><span class="p">,</span> <span class="mi">2736</span><span class="p">,</span> <span class="mi">2745</span><span class="p">,</span> <span class="mi">2746</span><span class="p">,</span> <span class="mi">2765</span><span class="p">,</span> <span class="mi">2770</span><span class="p">,</span> <span class="mi">2782</span><span class="p">,</span>
       <span class="mi">2806</span><span class="p">,</span> <span class="mi">2817</span><span class="p">,</span> <span class="mi">2826</span><span class="p">,</span> <span class="mi">2839</span><span class="p">,</span> <span class="mi">2854</span><span class="p">,</span> <span class="mi">2864</span><span class="p">,</span> <span class="mi">2873</span><span class="p">,</span> <span class="mi">2882</span><span class="p">,</span> <span class="mi">2890</span><span class="p">,</span> <span class="mi">2897</span><span class="p">,</span> <span class="mi">2899</span><span class="p">,</span>
       <span class="mi">2904</span><span class="p">,</span> <span class="mi">2914</span><span class="p">,</span> <span class="mi">2919</span><span class="p">,</span> <span class="mi">2935</span><span class="p">,</span> <span class="mi">2944</span><span class="p">,</span> <span class="mi">2952</span><span class="p">,</span> <span class="mi">2955</span><span class="p">,</span> <span class="mi">2974</span><span class="p">,</span> <span class="mi">2975</span><span class="p">,</span> <span class="mi">2996</span><span class="p">,</span> <span class="mi">3001</span><span class="p">,</span>
       <span class="mi">3012</span><span class="p">,</span> <span class="mi">3015</span><span class="p">,</span> <span class="mi">3016</span><span class="p">,</span> <span class="mi">3021</span><span class="p">,</span> <span class="mi">3024</span><span class="p">,</span> <span class="mi">3035</span><span class="p">,</span> <span class="mi">3049</span><span class="p">,</span> <span class="mi">3067</span><span class="p">,</span> <span class="mi">3106</span><span class="p">,</span> <span class="mi">3107</span><span class="p">,</span> <span class="mi">3128</span><span class="p">,</span>
       <span class="mi">3131</span><span class="p">,</span> <span class="mi">3135</span><span class="p">,</span> <span class="mi">3143</span><span class="p">,</span> <span class="mi">3160</span><span class="p">,</span> <span class="mi">3175</span><span class="p">,</span> <span class="mi">3195</span><span class="p">,</span> <span class="mi">3198</span><span class="p">,</span> <span class="mi">3213</span><span class="p">,</span> <span class="mi">3231</span><span class="p">,</span> <span class="mi">3241</span><span class="p">,</span> <span class="mi">3247</span><span class="p">,</span>
       <span class="mi">3248</span><span class="p">,</span> <span class="mi">3259</span><span class="p">,</span> <span class="mi">3262</span><span class="p">,</span> <span class="mi">3269</span><span class="p">,</span> <span class="mi">3286</span><span class="p">,</span> <span class="mi">3309</span><span class="p">,</span> <span class="mi">3328</span><span class="p">,</span> <span class="mi">3337</span><span class="p">,</span> <span class="mi">3367</span><span class="p">,</span> <span class="mi">3369</span><span class="p">,</span> <span class="mi">3376</span><span class="p">,</span>
       <span class="mi">3377</span><span class="p">,</span> <span class="mi">3391</span><span class="p">,</span> <span class="mi">3396</span><span class="p">,</span> <span class="mi">3409</span><span class="p">,</span> <span class="mi">3410</span><span class="p">,</span> <span class="mi">3429</span><span class="p">,</span> <span class="mi">3434</span><span class="p">,</span> <span class="mi">3441</span><span class="p">,</span> <span class="mi">3443</span><span class="p">,</span> <span class="mi">3461</span><span class="p">,</span> <span class="mi">3479</span><span class="p">,</span>
       <span class="mi">3490</span><span class="p">,</span> <span class="mi">3492</span><span class="p">,</span> <span class="mi">3514</span><span class="p">,</span> <span class="mi">3516</span><span class="p">,</span> <span class="mi">3529</span><span class="p">,</span> <span class="mi">3534</span><span class="p">,</span> <span class="mi">3541</span><span class="p">,</span> <span class="mi">3562</span><span class="p">,</span> <span class="mi">3565</span><span class="p">,</span> <span class="mi">3568</span><span class="p">,</span> <span class="mi">3585</span><span class="p">,</span>
       <span class="mi">3590</span><span class="p">,</span> <span class="mi">3603</span><span class="p">,</span> <span class="mi">3610</span><span class="p">,</span> <span class="mi">3612</span><span class="p">])}</span>
<span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span>   <span class="mi">1</span><span class="p">,</span>   <span class="mi">21</span><span class="p">,</span>   <span class="mi">34</span><span class="p">,</span>   <span class="mi">37</span><span class="p">,</span>   <span class="mi">51</span><span class="p">,</span>   <span class="mi">56</span><span class="p">,</span>   <span class="mi">63</span><span class="p">,</span>   <span class="mi">68</span><span class="p">,</span>   <span class="mi">69</span><span class="p">,</span>   <span class="mi">75</span><span class="p">,</span>   <span class="mi">81</span><span class="p">,</span>
         <span class="mi">88</span><span class="p">,</span>   <span class="mi">95</span><span class="p">,</span>  <span class="mi">108</span><span class="p">,</span>  <span class="mi">114</span><span class="p">,</span>  <span class="mi">118</span><span class="p">,</span>  <span class="mi">119</span><span class="p">,</span>  <span class="mi">121</span><span class="p">,</span>  <span class="mi">156</span><span class="p">,</span>  <span class="mi">169</span><span class="p">,</span>  <span class="mi">192</span><span class="p">,</span>  <span class="mi">206</span><span class="p">,</span>
        <span class="mi">209</span><span class="p">,</span>  <span class="mi">210</span><span class="p">,</span>  <span class="mi">216</span><span class="p">,</span>  <span class="mi">229</span><span class="p">,</span>  <span class="mi">232</span><span class="p">,</span>  <span class="mi">234</span><span class="p">,</span>  <span class="mi">246</span><span class="p">,</span>  <span class="mi">249</span><span class="p">,</span>  <span class="mi">260</span><span class="p">,</span>  <span class="mi">283</span><span class="p">,</span>  <span class="mi">293</span><span class="p">,</span>
        <span class="mi">296</span><span class="p">,</span>  <span class="mi">303</span><span class="p">,</span>  <span class="mi">320</span><span class="p">,</span>  <span class="mi">326</span><span class="p">,</span>  <span class="mi">359</span><span class="p">,</span>  <span class="mi">399</span><span class="p">,</span>  <span class="mi">427</span><span class="p">,</span>  <span class="mi">429</span><span class="p">,</span>  <span class="mi">435</span><span class="p">,</span>  <span class="mi">440</span><span class="p">,</span>  <span class="mi">451</span><span class="p">,</span>
        <span class="mi">453</span><span class="p">,</span>  <span class="mi">458</span><span class="p">,</span>  <span class="mi">462</span><span class="p">,</span>  <span class="mi">464</span><span class="p">,</span>  <span class="mi">473</span><span class="p">,</span>  <span class="mi">489</span><span class="p">,</span>  <span class="mi">519</span><span class="p">,</span>  <span class="mi">524</span><span class="p">,</span>  <span class="mi">526</span><span class="p">,</span>  <span class="mi">527</span><span class="p">,</span>  <span class="mi">542</span><span class="p">,</span>
        <span class="mi">577</span><span class="p">,</span>  <span class="mi">582</span><span class="p">,</span>  <span class="mi">596</span><span class="p">,</span>  <span class="mi">603</span><span class="p">,</span>  <span class="mi">612</span><span class="p">,</span>  <span class="mi">633</span><span class="p">,</span>  <span class="mi">639</span><span class="p">,</span>  <span class="mi">656</span><span class="p">,</span>  <span class="mi">662</span><span class="p">,</span>  <span class="mi">666</span><span class="p">,</span>  <span class="mi">667</span><span class="p">,</span>
        <span class="mi">668</span><span class="p">,</span>  <span class="mi">669</span><span class="p">,</span>  <span class="mi">689</span><span class="p">,</span>  <span class="mi">702</span><span class="p">,</span>  <span class="mi">709</span><span class="p">,</span>  <span class="mi">712</span><span class="p">,</span>  <span class="mi">733</span><span class="p">,</span>  <span class="mi">743</span><span class="p">,</span>  <span class="mi">745</span><span class="p">,</span>  <span class="mi">776</span><span class="p">,</span>  <span class="mi">781</span><span class="p">,</span>
        <span class="mi">787</span><span class="p">,</span>  <span class="mi">790</span><span class="p">,</span>  <span class="mi">818</span><span class="p">,</span>  <span class="mi">825</span><span class="p">,</span>  <span class="mi">849</span><span class="p">,</span>  <span class="mi">859</span><span class="p">,</span>  <span class="mi">860</span><span class="p">,</span>  <span class="mi">869</span><span class="p">,</span>  <span class="mi">872</span><span class="p">,</span>  <span class="mi">889</span><span class="p">,</span>  <span class="mi">903</span><span class="p">,</span>
        <span class="mi">927</span><span class="p">,</span>  <span class="mi">943</span><span class="p">,</span>  <span class="mi">949</span><span class="p">,</span>  <span class="mi">952</span><span class="p">,</span>  <span class="mi">957</span><span class="p">,</span>  <span class="mi">965</span><span class="p">,</span>  <span class="mi">979</span><span class="p">,</span>  <span class="mi">984</span><span class="p">,</span>  <span class="mi">997</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">1015</span><span class="p">,</span>
       <span class="mi">1018</span><span class="p">,</span> <span class="mi">1028</span><span class="p">,</span> <span class="mi">1029</span><span class="p">,</span> <span class="mi">1040</span><span class="p">,</span> <span class="mi">1046</span><span class="p">,</span> <span class="mi">1049</span><span class="p">,</span> <span class="mi">1076</span><span class="p">,</span> <span class="mi">1078</span><span class="p">,</span> <span class="mi">1090</span><span class="p">,</span> <span class="mi">1093</span><span class="p">,</span> <span class="mi">1102</span><span class="p">,</span>
       <span class="mi">1107</span><span class="p">,</span> <span class="mi">1128</span><span class="p">,</span> <span class="mi">1137</span><span class="p">,</span> <span class="mi">1152</span><span class="p">,</span> <span class="mi">1168</span><span class="p">,</span> <span class="mi">1179</span><span class="p">,</span> <span class="mi">1195</span><span class="p">,</span> <span class="mi">1209</span><span class="p">,</span> <span class="mi">1268</span><span class="p">,</span> <span class="mi">1304</span><span class="p">,</span> <span class="mi">1310</span><span class="p">,</span>
       <span class="mi">1346</span><span class="p">,</span> <span class="mi">1349</span><span class="p">,</span> <span class="mi">1359</span><span class="p">,</span> <span class="mi">1363</span><span class="p">,</span> <span class="mi">1367</span><span class="p">,</span> <span class="mi">1368</span><span class="p">,</span> <span class="mi">1371</span><span class="p">,</span> <span class="mi">1372</span><span class="p">,</span> <span class="mi">1377</span><span class="p">,</span> <span class="mi">1386</span><span class="p">,</span> <span class="mi">1387</span><span class="p">,</span>
       <span class="mi">1403</span><span class="p">,</span> <span class="mi">1423</span><span class="p">,</span> <span class="mi">1443</span><span class="p">,</span> <span class="mi">1454</span><span class="p">,</span> <span class="mi">1471</span><span class="p">,</span> <span class="mi">1479</span><span class="p">,</span> <span class="mi">1489</span><span class="p">,</span> <span class="mi">1495</span><span class="p">,</span> <span class="mi">1501</span><span class="p">,</span> <span class="mi">1502</span><span class="p">,</span> <span class="mi">1512</span><span class="p">,</span>
       <span class="mi">1517</span><span class="p">,</span> <span class="mi">1530</span><span class="p">,</span> <span class="mi">1532</span><span class="p">,</span> <span class="mi">1571</span><span class="p">,</span> <span class="mi">1578</span><span class="p">,</span> <span class="mi">1590</span><span class="p">,</span> <span class="mi">1596</span><span class="p">,</span> <span class="mi">1600</span><span class="p">,</span> <span class="mi">1605</span><span class="p">,</span> <span class="mi">1606</span><span class="p">,</span> <span class="mi">1625</span><span class="p">,</span>
       <span class="mi">1626</span><span class="p">,</span> <span class="mi">1645</span><span class="p">,</span> <span class="mi">1664</span><span class="p">,</span> <span class="mi">1678</span><span class="p">,</span> <span class="mi">1682</span><span class="p">,</span> <span class="mi">1701</span><span class="p">,</span> <span class="mi">1709</span><span class="p">,</span> <span class="mi">1712</span><span class="p">,</span> <span class="mi">1723</span><span class="p">,</span> <span class="mi">1725</span><span class="p">,</span> <span class="mi">1729</span><span class="p">,</span>
       <span class="mi">1742</span><span class="p">,</span> <span class="mi">1769</span><span class="p">,</span> <span class="mi">1771</span><span class="p">,</span> <span class="mi">1775</span><span class="p">,</span> <span class="mi">1796</span><span class="p">,</span> <span class="mi">1797</span><span class="p">,</span> <span class="mi">1798</span><span class="p">,</span> <span class="mi">1819</span><span class="p">,</span> <span class="mi">1828</span><span class="p">,</span> <span class="mi">1837</span><span class="p">,</span> <span class="mi">1857</span><span class="p">,</span>
       <span class="mi">1868</span><span class="p">,</span> <span class="mi">1876</span><span class="p">,</span> <span class="mi">1877</span><span class="p">,</span> <span class="mi">1897</span><span class="p">,</span> <span class="mi">1904</span><span class="p">,</span> <span class="mi">1907</span><span class="p">,</span> <span class="mi">1916</span><span class="p">,</span> <span class="mi">1926</span><span class="p">,</span> <span class="mi">1927</span><span class="p">,</span> <span class="mi">1930</span><span class="p">,</span> <span class="mi">1956</span><span class="p">,</span>
       <span class="mi">1963</span><span class="p">,</span> <span class="mi">1969</span><span class="p">,</span> <span class="mi">1995</span><span class="p">,</span> <span class="mi">1999</span><span class="p">,</span> <span class="mi">2009</span><span class="p">,</span> <span class="mi">2051</span><span class="p">,</span> <span class="mi">2058</span><span class="p">,</span> <span class="mi">2066</span><span class="p">,</span> <span class="mi">2079</span><span class="p">,</span> <span class="mi">2081</span><span class="p">,</span> <span class="mi">2082</span><span class="p">,</span>
       <span class="mi">2084</span><span class="p">,</span> <span class="mi">2100</span><span class="p">,</span> <span class="mi">2101</span><span class="p">,</span> <span class="mi">2112</span><span class="p">,</span> <span class="mi">2121</span><span class="p">,</span> <span class="mi">2144</span><span class="p">,</span> <span class="mi">2147</span><span class="p">,</span> <span class="mi">2160</span><span class="p">,</span> <span class="mi">2191</span><span class="p">,</span> <span class="mi">2192</span><span class="p">,</span> <span class="mi">2195</span><span class="p">,</span>
       <span class="mi">2218</span><span class="p">,</span> <span class="mi">2245</span><span class="p">,</span> <span class="mi">2253</span><span class="p">,</span> <span class="mi">2257</span><span class="p">,</span> <span class="mi">2269</span><span class="p">,</span> <span class="mi">2278</span><span class="p">,</span> <span class="mi">2298</span><span class="p">,</span> <span class="mi">2310</span><span class="p">,</span> <span class="mi">2325</span><span class="p">,</span> <span class="mi">2327</span><span class="p">,</span> <span class="mi">2333</span><span class="p">,</span>
       <span class="mi">2340</span><span class="p">,</span> <span class="mi">2352</span><span class="p">,</span> <span class="mi">2353</span><span class="p">,</span> <span class="mi">2373</span><span class="p">,</span> <span class="mi">2396</span><span class="p">,</span> <span class="mi">2403</span><span class="p">,</span> <span class="mi">2404</span><span class="p">,</span> <span class="mi">2411</span><span class="p">,</span> <span class="mi">2435</span><span class="p">,</span> <span class="mi">2436</span><span class="p">,</span> <span class="mi">2440</span><span class="p">,</span>
       <span class="mi">2473</span><span class="p">,</span> <span class="mi">2483</span><span class="p">,</span> <span class="mi">2493</span><span class="p">,</span> <span class="mi">2500</span><span class="p">,</span> <span class="mi">2525</span><span class="p">,</span> <span class="mi">2526</span><span class="p">,</span> <span class="mi">2528</span><span class="p">,</span> <span class="mi">2532</span><span class="p">,</span> <span class="mi">2538</span><span class="p">,</span> <span class="mi">2539</span><span class="p">,</span> <span class="mi">2557</span><span class="p">,</span>
       <span class="mi">2561</span><span class="p">,</span> <span class="mi">2581</span><span class="p">,</span> <span class="mi">2582</span><span class="p">,</span> <span class="mi">2584</span><span class="p">,</span> <span class="mi">2586</span><span class="p">,</span> <span class="mi">2597</span><span class="p">,</span> <span class="mi">2606</span><span class="p">,</span> <span class="mi">2615</span><span class="p">,</span> <span class="mi">2617</span><span class="p">,</span> <span class="mi">2621</span><span class="p">,</span> <span class="mi">2624</span><span class="p">,</span>
       <span class="mi">2629</span><span class="p">,</span> <span class="mi">2642</span><span class="p">,</span> <span class="mi">2709</span><span class="p">,</span> <span class="mi">2718</span><span class="p">,</span> <span class="mi">2729</span><span class="p">,</span> <span class="mi">2736</span><span class="p">,</span> <span class="mi">2745</span><span class="p">,</span> <span class="mi">2746</span><span class="p">,</span> <span class="mi">2765</span><span class="p">,</span> <span class="mi">2770</span><span class="p">,</span> <span class="mi">2782</span><span class="p">,</span>
       <span class="mi">2806</span><span class="p">,</span> <span class="mi">2817</span><span class="p">,</span> <span class="mi">2826</span><span class="p">,</span> <span class="mi">2839</span><span class="p">,</span> <span class="mi">2854</span><span class="p">,</span> <span class="mi">2864</span><span class="p">,</span> <span class="mi">2873</span><span class="p">,</span> <span class="mi">2882</span><span class="p">,</span> <span class="mi">2890</span><span class="p">,</span> <span class="mi">2897</span><span class="p">,</span> <span class="mi">2899</span><span class="p">,</span>
       <span class="mi">2904</span><span class="p">,</span> <span class="mi">2914</span><span class="p">,</span> <span class="mi">2919</span><span class="p">,</span> <span class="mi">2935</span><span class="p">,</span> <span class="mi">2944</span><span class="p">,</span> <span class="mi">2952</span><span class="p">,</span> <span class="mi">2955</span><span class="p">,</span> <span class="mi">2974</span><span class="p">,</span> <span class="mi">2975</span><span class="p">,</span> <span class="mi">2996</span><span class="p">,</span> <span class="mi">3001</span><span class="p">,</span>
       <span class="mi">3012</span><span class="p">,</span> <span class="mi">3015</span><span class="p">,</span> <span class="mi">3016</span><span class="p">,</span> <span class="mi">3021</span><span class="p">,</span> <span class="mi">3024</span><span class="p">,</span> <span class="mi">3035</span><span class="p">,</span> <span class="mi">3049</span><span class="p">,</span> <span class="mi">3067</span><span class="p">,</span> <span class="mi">3106</span><span class="p">,</span> <span class="mi">3107</span><span class="p">,</span> <span class="mi">3128</span><span class="p">,</span>
       <span class="mi">3131</span><span class="p">,</span> <span class="mi">3135</span><span class="p">,</span> <span class="mi">3143</span><span class="p">,</span> <span class="mi">3160</span><span class="p">,</span> <span class="mi">3175</span><span class="p">,</span> <span class="mi">3195</span><span class="p">,</span> <span class="mi">3198</span><span class="p">,</span> <span class="mi">3213</span><span class="p">,</span> <span class="mi">3231</span><span class="p">,</span> <span class="mi">3241</span><span class="p">,</span> <span class="mi">3247</span><span class="p">,</span>
       <span class="mi">3248</span><span class="p">,</span> <span class="mi">3259</span><span class="p">,</span> <span class="mi">3262</span><span class="p">,</span> <span class="mi">3269</span><span class="p">,</span> <span class="mi">3286</span><span class="p">,</span> <span class="mi">3309</span><span class="p">,</span> <span class="mi">3328</span><span class="p">,</span> <span class="mi">3337</span><span class="p">,</span> <span class="mi">3367</span><span class="p">,</span> <span class="mi">3369</span><span class="p">,</span> <span class="mi">3376</span><span class="p">,</span>
       <span class="mi">3377</span><span class="p">,</span> <span class="mi">3391</span><span class="p">,</span> <span class="mi">3396</span><span class="p">,</span> <span class="mi">3409</span><span class="p">,</span> <span class="mi">3410</span><span class="p">,</span> <span class="mi">3429</span><span class="p">,</span> <span class="mi">3434</span><span class="p">,</span> <span class="mi">3441</span><span class="p">,</span> <span class="mi">3443</span><span class="p">,</span> <span class="mi">3461</span><span class="p">,</span> <span class="mi">3479</span><span class="p">,</span>
       <span class="mi">3490</span><span class="p">,</span> <span class="mi">3492</span><span class="p">,</span> <span class="mi">3514</span><span class="p">,</span> <span class="mi">3516</span><span class="p">,</span> <span class="mi">3529</span><span class="p">,</span> <span class="mi">3534</span><span class="p">,</span> <span class="mi">3541</span><span class="p">,</span> <span class="mi">3562</span><span class="p">,</span> <span class="mi">3565</span><span class="p">,</span> <span class="mi">3568</span><span class="p">,</span> <span class="mi">3585</span><span class="p">,</span>
       <span class="mi">3590</span><span class="p">,</span> <span class="mi">3603</span><span class="p">,</span> <span class="mi">3610</span><span class="p">,</span> <span class="mi">3612</span><span class="p">]),</span> <span class="mi">1</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span><span class="mi">3622</span><span class="p">,</span> <span class="mi">3632</span><span class="p">,</span> <span class="mi">3661</span><span class="p">,</span> <span class="mi">3667</span><span class="p">,</span> <span class="mi">3673</span><span class="p">,</span> <span class="mi">3677</span><span class="p">,</span> <span class="mi">3691</span><span class="p">,</span> <span class="mi">3693</span><span class="p">,</span> <span class="mi">3698</span><span class="p">,</span> <span class="mi">3702</span><span class="p">,</span> <span class="mi">3709</span><span class="p">,</span>
       <span class="mi">3715</span><span class="p">,</span> <span class="mi">3720</span><span class="p">,</span> <span class="mi">3734</span><span class="p">,</span> <span class="mi">3743</span><span class="p">,</span> <span class="mi">3776</span><span class="p">,</span> <span class="mi">3777</span><span class="p">,</span> <span class="mi">3778</span><span class="p">,</span> <span class="mi">3806</span><span class="p">,</span> <span class="mi">3809</span><span class="p">,</span> <span class="mi">3829</span><span class="p">,</span> <span class="mi">3849</span><span class="p">,</span>
       <span class="mi">3876</span><span class="p">,</span> <span class="mi">3881</span><span class="p">,</span> <span class="mi">3882</span><span class="p">,</span> <span class="mi">3884</span><span class="p">,</span> <span class="mi">3888</span><span class="p">,</span> <span class="mi">3896</span><span class="p">,</span> <span class="mi">3906</span><span class="p">,</span> <span class="mi">3929</span><span class="p">,</span> <span class="mi">3937</span><span class="p">,</span> <span class="mi">3943</span><span class="p">,</span> <span class="mi">3953</span><span class="p">,</span>
       <span class="mi">3964</span><span class="p">,</span> <span class="mi">4002</span><span class="p">,</span> <span class="mi">4008</span><span class="p">,</span> <span class="mi">4009</span><span class="p">,</span> <span class="mi">4023</span><span class="p">,</span> <span class="mi">4027</span><span class="p">,</span> <span class="mi">4044</span><span class="p">,</span> <span class="mi">4047</span><span class="p">,</span> <span class="mi">4067</span><span class="p">,</span> <span class="mi">4082</span><span class="p">,</span> <span class="mi">4106</span><span class="p">,</span>
       <span class="mi">4108</span><span class="p">,</span> <span class="mi">4115</span><span class="p">,</span> <span class="mi">4123</span><span class="p">,</span> <span class="mi">4142</span><span class="p">,</span> <span class="mi">4145</span><span class="p">,</span> <span class="mi">4159</span><span class="p">,</span> <span class="mi">4181</span><span class="p">,</span> <span class="mi">4201</span><span class="p">,</span> <span class="mi">4203</span><span class="p">,</span> <span class="mi">4216</span><span class="p">,</span> <span class="mi">4218</span><span class="p">,</span>
       <span class="mi">4220</span><span class="p">,</span> <span class="mi">4239</span><span class="p">,</span> <span class="mi">4245</span><span class="p">,</span> <span class="mi">4265</span><span class="p">,</span> <span class="mi">4270</span><span class="p">,</span> <span class="mi">4279</span><span class="p">,</span> <span class="mi">4284</span><span class="p">,</span> <span class="mi">4288</span><span class="p">,</span> <span class="mi">4289</span><span class="p">,</span> <span class="mi">4310</span><span class="p">,</span> <span class="mi">4316</span><span class="p">,</span>
       <span class="mi">4321</span><span class="p">,</span> <span class="mi">4325</span><span class="p">,</span> <span class="mi">4340</span><span class="p">,</span> <span class="mi">4343</span><span class="p">,</span> <span class="mi">4344</span><span class="p">,</span> <span class="mi">4347</span><span class="p">,</span> <span class="mi">4356</span><span class="p">,</span> <span class="mi">4374</span><span class="p">,</span> <span class="mi">4389</span><span class="p">,</span> <span class="mi">4415</span><span class="p">,</span> <span class="mi">4444</span><span class="p">,</span>
       <span class="mi">4453</span><span class="p">,</span> <span class="mi">4455</span><span class="p">,</span> <span class="mi">4465</span><span class="p">,</span> <span class="mi">4485</span><span class="p">,</span> <span class="mi">4488</span><span class="p">,</span> <span class="mi">4496</span><span class="p">,</span> <span class="mi">4500</span><span class="p">,</span> <span class="mi">4505</span><span class="p">,</span> <span class="mi">4527</span><span class="p">,</span> <span class="mi">4532</span><span class="p">,</span> <span class="mi">4535</span><span class="p">,</span>
       <span class="mi">4539</span><span class="p">,</span> <span class="mi">4556</span><span class="p">,</span> <span class="mi">4563</span><span class="p">,</span> <span class="mi">4565</span><span class="p">,</span> <span class="mi">4588</span><span class="p">,</span> <span class="mi">4597</span><span class="p">,</span> <span class="mi">4607</span><span class="p">,</span> <span class="mi">4608</span><span class="p">,</span> <span class="mi">4624</span><span class="p">,</span> <span class="mi">4629</span><span class="p">,</span> <span class="mi">4642</span><span class="p">,</span>
       <span class="mi">4653</span><span class="p">,</span> <span class="mi">4655</span><span class="p">,</span> <span class="mi">4656</span><span class="p">,</span> <span class="mi">4682</span><span class="p">,</span> <span class="mi">4686</span><span class="p">,</span> <span class="mi">4688</span><span class="p">,</span> <span class="mi">4713</span><span class="p">,</span> <span class="mi">4718</span><span class="p">,</span> <span class="mi">4729</span><span class="p">,</span> <span class="mi">4738</span><span class="p">,</span> <span class="mi">4744</span><span class="p">,</span>
       <span class="mi">4748</span><span class="p">,</span> <span class="mi">4749</span><span class="p">,</span> <span class="mi">4756</span><span class="p">,</span> <span class="mi">4773</span><span class="p">,</span> <span class="mi">4776</span><span class="p">,</span> <span class="mi">4793</span><span class="p">,</span> <span class="mi">4804</span><span class="p">,</span> <span class="mi">4849</span><span class="p">,</span> <span class="mi">4852</span><span class="p">,</span> <span class="mi">4854</span><span class="p">,</span> <span class="mi">4855</span><span class="p">,</span>
       <span class="mi">4870</span><span class="p">,</span> <span class="mi">4889</span><span class="p">,</span> <span class="mi">4892</span><span class="p">,</span> <span class="mi">4906</span><span class="p">,</span> <span class="mi">4911</span><span class="p">,</span> <span class="mi">4918</span><span class="p">,</span> <span class="mi">4926</span><span class="p">,</span> <span class="mi">4931</span><span class="p">,</span> <span class="mi">4951</span><span class="p">,</span> <span class="mi">4962</span><span class="p">,</span> <span class="mi">4981</span><span class="p">,</span>
       <span class="mi">4985</span><span class="p">,</span> <span class="mi">4994</span><span class="p">,</span> <span class="mi">5007</span><span class="p">,</span> <span class="mi">5010</span><span class="p">,</span> <span class="mi">5015</span><span class="p">,</span> <span class="mi">5019</span><span class="p">,</span> <span class="mi">5048</span><span class="p">,</span> <span class="mi">5052</span><span class="p">,</span> <span class="mi">5053</span><span class="p">,</span> <span class="mi">5072</span><span class="p">,</span> <span class="mi">5074</span><span class="p">,</span>
       <span class="mi">5082</span><span class="p">,</span> <span class="mi">5083</span><span class="p">,</span> <span class="mi">5096</span><span class="p">,</span> <span class="mi">5108</span><span class="p">,</span> <span class="mi">5115</span><span class="p">,</span> <span class="mi">5120</span><span class="p">,</span> <span class="mi">5131</span><span class="p">,</span> <span class="mi">5133</span><span class="p">,</span> <span class="mi">5144</span><span class="p">,</span> <span class="mi">5147</span><span class="p">,</span> <span class="mi">5154</span><span class="p">,</span>
       <span class="mi">5167</span><span class="p">,</span> <span class="mi">5187</span><span class="p">,</span> <span class="mi">5192</span><span class="p">,</span> <span class="mi">5194</span><span class="p">,</span> <span class="mi">5196</span><span class="p">,</span> <span class="mi">5202</span><span class="p">,</span> <span class="mi">5203</span><span class="p">,</span> <span class="mi">5228</span><span class="p">,</span> <span class="mi">5244</span><span class="p">,</span> <span class="mi">5246</span><span class="p">,</span> <span class="mi">5249</span><span class="p">,</span>
       <span class="mi">5266</span><span class="p">,</span> <span class="mi">5268</span><span class="p">,</span> <span class="mi">5272</span><span class="p">,</span> <span class="mi">5275</span><span class="p">,</span> <span class="mi">5285</span><span class="p">,</span> <span class="mi">5286</span><span class="p">,</span> <span class="mi">5288</span><span class="p">,</span> <span class="mi">5298</span><span class="p">,</span> <span class="mi">5317</span><span class="p">,</span> <span class="mi">5319</span><span class="p">,</span> <span class="mi">5321</span><span class="p">,</span>
       <span class="mi">5327</span><span class="p">,</span> <span class="mi">5330</span><span class="p">,</span> <span class="mi">5340</span><span class="p">,</span> <span class="mi">5342</span><span class="p">,</span> <span class="mi">5344</span><span class="p">,</span> <span class="mi">5353</span><span class="p">,</span> <span class="mi">5368</span><span class="p">,</span> <span class="mi">5373</span><span class="p">,</span> <span class="mi">5393</span><span class="p">,</span> <span class="mi">5398</span><span class="p">,</span> <span class="mi">5461</span><span class="p">,</span>
       <span class="mi">5462</span><span class="p">,</span> <span class="mi">5464</span><span class="p">,</span> <span class="mi">5468</span><span class="p">,</span> <span class="mi">5469</span><span class="p">,</span> <span class="mi">5470</span><span class="p">,</span> <span class="mi">5475</span><span class="p">,</span> <span class="mi">5487</span><span class="p">,</span> <span class="mi">5488</span><span class="p">,</span> <span class="mi">5498</span><span class="p">,</span> <span class="mi">5502</span><span class="p">,</span> <span class="mi">5505</span><span class="p">,</span>
       <span class="mi">5512</span><span class="p">,</span> <span class="mi">5514</span><span class="p">,</span> <span class="mi">5525</span><span class="p">,</span> <span class="mi">5541</span><span class="p">,</span> <span class="mi">5560</span><span class="p">,</span> <span class="mi">5563</span><span class="p">,</span> <span class="mi">5583</span><span class="p">,</span> <span class="mi">5585</span><span class="p">,</span> <span class="mi">5604</span><span class="p">,</span> <span class="mi">5608</span><span class="p">,</span> <span class="mi">5612</span><span class="p">,</span>
       <span class="mi">5615</span><span class="p">,</span> <span class="mi">5622</span><span class="p">,</span> <span class="mi">5627</span><span class="p">,</span> <span class="mi">5641</span><span class="p">,</span> <span class="mi">5646</span><span class="p">,</span> <span class="mi">5662</span><span class="p">,</span> <span class="mi">5665</span><span class="p">,</span> <span class="mi">5674</span><span class="p">,</span> <span class="mi">5690</span><span class="p">,</span> <span class="mi">5692</span><span class="p">,</span> <span class="mi">5694</span><span class="p">,</span>
       <span class="mi">5697</span><span class="p">,</span> <span class="mi">5698</span><span class="p">,</span> <span class="mi">5711</span><span class="p">,</span> <span class="mi">5729</span><span class="p">,</span> <span class="mi">5730</span><span class="p">,</span> <span class="mi">5747</span><span class="p">,</span> <span class="mi">5767</span><span class="p">,</span> <span class="mi">5773</span><span class="p">,</span> <span class="mi">5801</span><span class="p">,</span> <span class="mi">5808</span><span class="p">,</span> <span class="mi">5809</span><span class="p">,</span>
       <span class="mi">5830</span><span class="p">,</span> <span class="mi">5844</span><span class="p">,</span> <span class="mi">5881</span><span class="p">,</span> <span class="mi">5883</span><span class="p">,</span> <span class="mi">5884</span><span class="p">,</span> <span class="mi">5886</span><span class="p">,</span> <span class="mi">5888</span><span class="p">,</span> <span class="mi">5905</span><span class="p">,</span> <span class="mi">5921</span><span class="p">,</span> <span class="mi">5927</span><span class="p">,</span> <span class="mi">5929</span><span class="p">,</span>
       <span class="mi">5932</span><span class="p">,</span> <span class="mi">5938</span><span class="p">,</span> <span class="mi">5961</span><span class="p">,</span> <span class="mi">5978</span><span class="p">,</span> <span class="mi">5981</span><span class="p">,</span> <span class="mi">6001</span><span class="p">,</span> <span class="mi">6008</span><span class="p">,</span> <span class="mi">6023</span><span class="p">,</span> <span class="mi">6034</span><span class="p">,</span> <span class="mi">6045</span><span class="p">,</span> <span class="mi">6065</span><span class="p">,</span>
       <span class="mi">6076</span><span class="p">,</span> <span class="mi">6094</span><span class="p">,</span> <span class="mi">6097</span><span class="p">,</span> <span class="mi">6103</span><span class="p">,</span> <span class="mi">6113</span><span class="p">,</span> <span class="mi">6117</span><span class="p">,</span> <span class="mi">6133</span><span class="p">,</span> <span class="mi">6137</span><span class="p">,</span> <span class="mi">6146</span><span class="p">,</span> <span class="mi">6179</span><span class="p">,</span> <span class="mi">6207</span><span class="p">,</span>
       <span class="mi">6227</span><span class="p">,</span> <span class="mi">6228</span><span class="p">,</span> <span class="mi">6245</span><span class="p">,</span> <span class="mi">6279</span><span class="p">,</span> <span class="mi">6292</span><span class="p">,</span> <span class="mi">6296</span><span class="p">,</span> <span class="mi">6302</span><span class="p">,</span> <span class="mi">6316</span><span class="p">,</span> <span class="mi">6320</span><span class="p">,</span> <span class="mi">6325</span><span class="p">,</span> <span class="mi">6326</span><span class="p">,</span>
       <span class="mi">6330</span><span class="p">,</span> <span class="mi">6331</span><span class="p">,</span> <span class="mi">6332</span><span class="p">,</span> <span class="mi">6337</span><span class="p">,</span> <span class="mi">6341</span><span class="p">,</span> <span class="mi">6357</span><span class="p">,</span> <span class="mi">6367</span><span class="p">,</span> <span class="mi">6394</span><span class="p">,</span> <span class="mi">6400</span><span class="p">,</span> <span class="mi">6406</span><span class="p">,</span> <span class="mi">6409</span><span class="p">,</span>
       <span class="mi">6421</span><span class="p">,</span> <span class="mi">6422</span><span class="p">,</span> <span class="mi">6441</span><span class="p">,</span> <span class="mi">6444</span><span class="p">,</span> <span class="mi">6446</span><span class="p">,</span> <span class="mi">6461</span><span class="p">,</span> <span class="mi">6468</span><span class="p">,</span> <span class="mi">6496</span><span class="p">,</span> <span class="mi">6502</span><span class="p">,</span> <span class="mi">6538</span><span class="p">,</span> <span class="mi">6591</span><span class="p">,</span>
       <span class="mi">6593</span><span class="p">,</span> <span class="mi">6603</span><span class="p">,</span> <span class="mi">6607</span><span class="p">,</span> <span class="mi">6611</span><span class="p">,</span> <span class="mi">6614</span><span class="p">,</span> <span class="mi">6615</span><span class="p">,</span> <span class="mi">6619</span><span class="p">,</span> <span class="mi">6629</span><span class="p">,</span> <span class="mi">6630</span><span class="p">,</span> <span class="mi">6645</span><span class="p">,</span> <span class="mi">6648</span><span class="p">,</span>
       <span class="mi">6663</span><span class="p">,</span> <span class="mi">6676</span><span class="p">,</span> <span class="mi">6681</span><span class="p">,</span> <span class="mi">6684</span><span class="p">,</span> <span class="mi">6700</span><span class="p">,</span> <span class="mi">6704</span><span class="p">,</span> <span class="mi">6708</span><span class="p">,</span> <span class="mi">6723</span><span class="p">,</span> <span class="mi">6730</span><span class="p">,</span> <span class="mi">6737</span><span class="p">,</span> <span class="mi">6738</span><span class="p">,</span>
       <span class="mi">6757</span><span class="p">,</span> <span class="mi">6758</span><span class="p">,</span> <span class="mi">6763</span><span class="p">,</span> <span class="mi">6768</span><span class="p">,</span> <span class="mi">6791</span><span class="p">,</span> <span class="mi">6802</span><span class="p">,</span> <span class="mi">6819</span><span class="p">,</span> <span class="mi">6823</span><span class="p">,</span> <span class="mi">6832</span><span class="p">,</span> <span class="mi">6847</span><span class="p">,</span> <span class="mi">6857</span><span class="p">,</span>
       <span class="mi">6875</span><span class="p">,</span> <span class="mi">6883</span><span class="p">,</span> <span class="mi">6917</span><span class="p">,</span> <span class="mi">6923</span><span class="p">,</span> <span class="mi">6928</span><span class="p">,</span> <span class="mi">6935</span><span class="p">,</span> <span class="mi">6958</span><span class="p">,</span> <span class="mi">6960</span><span class="p">,</span> <span class="mi">6967</span><span class="p">,</span> <span class="mi">6968</span><span class="p">,</span> <span class="mi">6970</span><span class="p">,</span>
       <span class="mi">6972</span><span class="p">,</span> <span class="mi">6973</span><span class="p">,</span> <span class="mi">6979</span><span class="p">,</span> <span class="mi">6987</span><span class="p">])}</span>
<span class="p">(</span><span class="n">Pdb</span><span class="p">)</span> <span class="n">p</span> <span class="n">dataidx_map</span>
<span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span>   <span class="mi">1</span><span class="p">,</span>   <span class="mi">21</span><span class="p">,</span>   <span class="mi">34</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">3510</span><span class="p">,</span> <span class="mi">3511</span><span class="p">,</span> <span class="mi">3519</span><span class="p">]),</span> <span class="mi">1</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span><span class="mi">3622</span><span class="p">,</span> <span class="mi">3632</span><span class="p">,</span> <span class="mi">3661</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">6964</span><span class="p">,</span> <span class="mi">6969</span><span class="p">,</span> <span class="mi">6993</span><span class="p">]),</span> <span class="mi">2</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span> <span class="mi">6991</span><span class="p">,</span>  <span class="mi">7003</span><span class="p">,</span>  <span class="mi">7004</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">10576</span><span class="p">,</span> <span class="mi">10577</span><span class="p">,</span> <span class="mi">10588</span><span class="p">]),</span> <span class="mi">3</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span><span class="mi">10276</span><span class="p">,</span> <span class="mi">1</span>
<span class="mi">0283</span><span class="p">,</span> <span class="mi">10323</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">13897</span><span class="p">,</span> <span class="mi">13898</span><span class="p">,</span> <span class="mi">13904</span><span class="p">]),</span> <span class="mi">4</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span><span class="mi">13799</span><span class="p">,</span> <span class="mi">13807</span><span class="p">,</span> <span class="mi">13808</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">17317</span><span class="p">,</span> <span class="mi">17319</span><span class="p">,</span> <span class="mi">17323</span><span class="p">]),</span> <span class="mi">5</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span><span class="mi">17360</span><span class="p">,</span> <span class="mi">17365</span><span class="p">,</span> <span class="mi">17376</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">20554</span><span class="p">,</span> <span class="mi">20562</span><span class="p">,</span> <span class="mi">20567</span><span class="p">]),</span> <span class="mi">6</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span><span class="mi">20816</span><span class="p">,</span> <span class="mi">20827</span><span class="p">,</span> <span class="mi">2</span>
<span class="mi">0840</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">24185</span><span class="p">,</span> <span class="mi">24193</span><span class="p">,</span> <span class="mi">24194</span><span class="p">]),</span> <span class="mi">7</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span><span class="mi">24419</span><span class="p">,</span> <span class="mi">24429</span><span class="p">,</span> <span class="mi">24440</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">27815</span><span class="p">,</span> <span class="mi">27817</span><span class="p">,</span> <span class="mi">27839</span><span class="p">]),</span> <span class="mi">8</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span><span class="mi">28102</span><span class="p">,</span> <span class="mi">28105</span><span class="p">,</span> <span class="mi">28108</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">31115</span><span class="p">,</span> <span class="mi">31120</span><span class="p">,</span> <span class="mi">31128</span><span class="p">]),</span> <span class="mi">9</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span><span class="mi">31425</span><span class="p">,</span> <span class="mi">31430</span><span class="p">,</span> <span class="mi">31445</span><span class="p">,</span> <span class="o">.</span>
<span class="o">..</span><span class="p">,</span> <span class="mi">34489</span><span class="p">,</span> <span class="mi">34491</span><span class="p">,</span> <span class="mi">34496</span><span class="p">]),</span> <span class="mi">10</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span><span class="mi">35192</span><span class="p">,</span> <span class="mi">35209</span><span class="p">,</span> <span class="mi">35217</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">37867</span><span class="p">,</span> <span class="mi">37873</span><span class="p">,</span> <span class="mi">37877</span><span class="p">]),</span> <span class="mi">11</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span><span class="mi">38729</span><span class="p">,</span> <span class="mi">38744</span><span class="p">,</span> <span class="mi">38746</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">41502</span><span class="p">,</span> <span class="mi">41503</span><span class="p">,</span> <span class="mi">41510</span><span class="p">]),</span> <span class="mi">12</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span><span class="mi">41987</span><span class="p">,</span> <span class="mi">41989</span><span class="p">,</span> <span class="mi">41999</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span>
<span class="mi">44882</span><span class="p">,</span> <span class="mi">44884</span><span class="p">,</span> <span class="mi">44890</span><span class="p">]),</span> <span class="mi">13</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span><span class="mi">45544</span><span class="p">,</span> <span class="mi">45557</span><span class="p">,</span> <span class="mi">45577</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">48616</span><span class="p">,</span> <span class="mi">48618</span><span class="p">,</span> <span class="mi">48633</span><span class="p">]),</span> <span class="mi">14</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span><span class="mi">49065</span><span class="p">,</span> <span class="mi">49075</span><span class="p">,</span> <span class="mi">49085</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">52232</span><span class="p">,</span> <span class="mi">52236</span><span class="p">,</span> <span class="mi">52239</span><span class="p">]),</span> <span class="mi">15</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span><span class="mi">52393</span><span class="p">,</span> <span class="mi">52396</span><span class="p">,</span> <span class="mi">52397</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">5585</span>
<span class="mi">9</span><span class="p">,</span> <span class="mi">55884</span><span class="p">,</span> <span class="mi">55889</span><span class="p">]),</span> <span class="mi">16</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span><span class="mi">55890</span><span class="p">,</span> <span class="mi">55892</span><span class="p">,</span> <span class="mi">55907</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">59458</span><span class="p">,</span> <span class="mi">59464</span><span class="p">,</span> <span class="mi">59486</span><span class="p">]),</span> <span class="mi">17</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span><span class="mi">59418</span><span class="p">,</span> <span class="mi">59420</span><span class="p">,</span> <span class="mi">59421</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">62983</span><span class="p">,</span> <span class="mi">63001</span><span class="p">,</span> <span class="mi">63005</span><span class="p">]),</span> <span class="mi">18</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span><span class="mi">63210</span><span class="p">,</span> <span class="mi">63215</span><span class="p">,</span> <span class="mi">63219</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">66214</span><span class="p">,</span> <span class="mi">6</span>
<span class="mi">6221</span><span class="p">,</span> <span class="mi">66228</span><span class="p">]),</span> <span class="mi">19</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span><span class="mi">66633</span><span class="p">,</span> <span class="mi">66643</span><span class="p">,</span> <span class="mi">66651</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">69945</span><span class="p">,</span> <span class="mi">69973</span><span class="p">,</span> <span class="mi">69992</span><span class="p">])}</span>
<span class="c1"># 划分好之后</span>
<span class="p">(</span><span class="n">Pdb</span><span class="p">)</span> <span class="n">p</span> <span class="n">dataidx_map</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">array</span><span class="p">([</span>   <span class="mi">1</span><span class="p">,</span>   <span class="mi">21</span><span class="p">,</span>   <span class="mi">34</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">3510</span><span class="p">,</span> <span class="mi">3511</span><span class="p">,</span> <span class="mi">3519</span><span class="p">])</span>
<span class="p">(</span><span class="n">Pdb</span><span class="p">)</span> <span class="n">p</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataidx_map</span><span class="p">[</span><span class="n">client</span><span class="p">])</span>
<span class="mi">3495</span>
<span class="p">(</span><span class="n">Pdb</span><span class="p">)</span> <span class="n">p</span> <span class="n">y</span><span class="p">[</span><span class="n">client</span><span class="p">]</span>
<span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int64</span><span class="p">)</span>
<span class="p">(</span><span class="n">Pdb</span><span class="p">)</span> <span class="n">p</span> <span class="n">y</span><span class="p">[</span><span class="n">client</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
<span class="p">(</span><span class="mi">3495</span><span class="p">,)</span>

<span class="c1"># 从给定的数组中提取出唯一元素，对提取的唯一元素进行排序</span>
<span class="p">(</span><span class="n">Pdb</span><span class="p">)</span> <span class="n">p</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">client</span><span class="p">])</span>
<span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int64</span><span class="p">)</span>
<span class="p">(</span><span class="n">Pdb</span><span class="p">)</span> <span class="n">p</span> <span class="n">statistic</span><span class="p">[</span><span class="n">client</span><span class="p">]</span>
<span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">345</span><span class="p">)]</span>
<span class="p">(</span><span class="n">Pdb</span><span class="p">)</span> <span class="n">p</span> <span class="n">statistic</span>
<span class="p">[[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">345</span><span class="p">)],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]]</span>
<span class="p">(</span><span class="n">Pdb</span><span class="p">)</span> <span class="n">p</span> <span class="n">statistic</span><span class="p">[</span><span class="n">client</span><span class="p">]</span>
<span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">348</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">410</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">359</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">358</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">345</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">328</span><span class="p">),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">359</span><span class="p">),</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">377</span><span class="p">),</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">346</span><span class="p">),</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">365</span><span class="p">)]</span>
<span class="p">(</span><span class="n">Pdb</span><span class="p">)</span> <span class="n">p</span> <span class="nb">len</span><span class="p">(</span><span class="n">statistic</span><span class="p">[</span><span class="n">client</span><span class="p">])</span>
<span class="mi">10</span>
<span class="p">(</span><span class="n">Pdb</span><span class="p">)</span> <span class="n">p</span> <span class="nb">len</span><span class="p">(</span><span class="n">statistic</span><span class="p">)</span>
<span class="mi">20</span>

<span class="c1"># 划分训练集和测试集</span>
<span class="p">(</span><span class="n">Pdb</span><span class="p">)</span> <span class="n">p</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="mi">20</span>
<span class="p">(</span><span class="n">Pdb</span><span class="p">)</span> <span class="n">p</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<span class="mi">3495</span>
<span class="p">(</span><span class="n">Pdb</span><span class="p">)</span> <span class="n">p</span> <span class="nb">len</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="mi">2621</span>
<span class="p">(</span><span class="n">Pdb</span><span class="p">)</span> <span class="n">p</span> <span class="nb">len</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="mi">874</span>
<span class="c1"># 划分之后 train_data[0]是一个字典，包含两个键值对</span>
<span class="c1"># &#39;x&#39;为client0对应的数据，&#39;y&#39;为标签</span>
<span class="p">(</span><span class="n">Pdb</span><span class="p">)</span> <span class="n">p</span> <span class="nb">len</span><span class="p">(</span><span class="n">train_data</span><span class="p">)</span>
<span class="mi">20</span>
<span class="p">(</span><span class="n">Pdb</span><span class="p">)</span> <span class="n">p</span> <span class="nb">len</span><span class="p">(</span><span class="n">train_data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="mi">2</span>
<span class="p">(</span><span class="n">Pdb</span><span class="p">)</span> <span class="n">p</span> <span class="nb">type</span><span class="p">(</span><span class="n">train_data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="o">&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">dict</span><span class="s1">&#39;&gt;</span>
<span class="p">(</span><span class="n">Pdb</span><span class="p">)</span> <span class="n">p</span> <span class="n">train_data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
<span class="p">(</span><span class="mi">2621</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">)</span>
<span class="p">(</span><span class="n">Pdb</span><span class="p">)</span> <span class="n">p</span> <span class="n">train_data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;y&#39;</span><span class="p">]</span>
<span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int64</span><span class="p">)</span>
<span class="p">(</span><span class="n">Pdb</span><span class="p">)</span> <span class="n">p</span> <span class="n">train_data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
<span class="p">(</span><span class="mi">2621</span><span class="p">,)</span>

<span class="c1"># 划分后每个客户端训练集和测试集的数量</span>
<span class="p">(</span><span class="n">Pdb</span><span class="p">)</span> <span class="n">p</span> <span class="n">num_samples</span>
<span class="p">{</span><span class="s1">&#39;train&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2621</span><span class="p">,</span> <span class="mi">2621</span><span class="p">,</span> <span class="mi">2621</span><span class="p">,</span> <span class="mi">2621</span><span class="p">,</span> <span class="mi">2621</span><span class="p">,</span> <span class="mi">2621</span><span class="p">,</span> <span class="mi">2621</span><span class="p">,</span> <span class="mi">2621</span><span class="p">,</span> <span class="mi">2621</span><span class="p">,</span> <span class="mi">2621</span><span class="p">,</span> <span class="mi">2621</span><span class="p">,</span> <span class="mi">2621</span><span class="p">,</span> <span class="mi">2621</span><span class="p">,</span> <span class="mi">2621</span><span class="p">,</span> <span class="mi">2621</span><span class="p">,</span> <span class="mi">2621</span><span class="p">,</span> <span class="mi">2621</span><span class="p">,</span> <span class="mi">2621</span><span class="p">,</span> <span class="mi">2621</span><span class="p">,</span> <span class="mi">2696</span><span class="p">],</span> <span class="s1">&#39;test&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">874</span><span class="p">,</span> <span class="mi">874</span><span class="p">,</span> <span class="mi">874</span><span class="p">,</span> <span class="mi">874</span><span class="p">,</span> <span class="mi">874</span><span class="p">,</span> <span class="mi">874</span><span class="p">,</span> <span class="mi">874</span><span class="p">,</span> <span class="mi">874</span><span class="p">,</span> <span class="mi">874</span>
<span class="p">,</span> <span class="mi">874</span><span class="p">,</span> <span class="mi">874</span><span class="p">,</span> <span class="mi">874</span><span class="p">,</span> <span class="mi">874</span><span class="p">,</span> <span class="mi">874</span><span class="p">,</span> <span class="mi">874</span><span class="p">,</span> <span class="mi">874</span><span class="p">,</span> <span class="mi">874</span><span class="p">,</span> <span class="mi">874</span><span class="p">,</span> <span class="mi">874</span><span class="p">,</span> <span class="mi">899</span><span class="p">]}</span>

</code></pre></td></tr></table>
</div>
</div><p><code>运行</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">rm ../dataset/mnist/config.json
cd ../dataset/
nohup python -u generate_mnist.py noniid - dir &gt; mnist_dataset.out 2&gt;&amp;1
</code></pre></td></tr></table>
</div>
</div><p>这是一个后台运行Python脚本的命令，使用了**<code>nohup</code>**命令来让命令在后台持续运行，同时将输出重定向到mnist_dataset.out文件中。**<code>-u</code>**选项在Python命令行中表示使用无缓冲的输出。它的作用是强制Python在标准输出和标准错误流中不进行缓冲，而是立即输出到终端。这对于实时查看脚本的输出或日志很有用，尤其是在脚本需要长时间运行或需要实时监控输出时。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">python</span> <span class="n">generate_mnist</span><span class="o">.</span><span class="n">py</span> <span class="n">iid</span> <span class="n">balance</span> <span class="o">-</span> <span class="c1"># for iid and balanced scenario</span>

<span class="n">Client</span> <span class="mi">0</span>	 <span class="n">Size</span> <span class="n">of</span> <span class="n">data</span><span class="p">:</span> <span class="mi">3495</span>	 <span class="n">Labels</span><span class="p">:</span>  <span class="p">[</span><span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">]</span>
		 <span class="n">Samples</span> <span class="n">of</span> <span class="n">labels</span><span class="p">:</span>  <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">345</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">393</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">349</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">357</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">341</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">315</span><span class="p">),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">343</span><span class="p">),</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">364</span><span class="p">),</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">341</span><span class="p">),</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">347</span><span class="p">)]</span>
<span class="o">--------------------------------------------------</span>
<span class="n">Client</span> <span class="mi">1</span>	 <span class="n">Size</span> <span class="n">of</span> <span class="n">data</span><span class="p">:</span> <span class="mi">3495</span>	 <span class="n">Labels</span><span class="p">:</span>  <span class="p">[</span><span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">]</span>
		 <span class="n">Samples</span> <span class="n">of</span> <span class="n">labels</span><span class="p">:</span>  <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">345</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">393</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">349</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">357</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">341</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">315</span><span class="p">),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">343</span><span class="p">),</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">364</span><span class="p">),</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">341</span><span class="p">),</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">347</span><span class="p">)]</span>
<span class="o">--------------------------------------------------</span>
<span class="n">Client</span> <span class="mi">2</span>	 <span class="n">Size</span> <span class="n">of</span> <span class="n">data</span><span class="p">:</span> <span class="mi">3495</span>	 <span class="n">Labels</span><span class="p">:</span>  <span class="p">[</span><span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">]</span>
		 <span class="n">Samples</span> <span class="n">of</span> <span class="n">labels</span><span class="p">:</span>  <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">345</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">393</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">349</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">357</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">341</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">315</span><span class="p">),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">343</span><span class="p">),</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">364</span><span class="p">),</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">341</span><span class="p">),</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">347</span><span class="p">)]</span>
<span class="o">--------------------------------------------------</span>
<span class="n">Client</span> <span class="mi">3</span>	 <span class="n">Size</span> <span class="n">of</span> <span class="n">data</span><span class="p">:</span> <span class="mi">3495</span>	 <span class="n">Labels</span><span class="p">:</span>  <span class="p">[</span><span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">]</span>
		 <span class="n">Samples</span> <span class="n">of</span> <span class="n">labels</span><span class="p">:</span>  <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">345</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">393</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">349</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">357</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">341</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">315</span><span class="p">),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">343</span><span class="p">),</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">364</span><span class="p">),</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">341</span><span class="p">),</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">347</span><span class="p">)]</span>
<span class="o">--------------------------------------------------</span>
<span class="n">Client</span> <span class="mi">4</span>	 <span class="n">Size</span> <span class="n">of</span> <span class="n">data</span><span class="p">:</span> <span class="mi">3495</span>	 <span class="n">Labels</span><span class="p">:</span>  <span class="p">[</span><span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">]</span>
		 <span class="n">Samples</span> <span class="n">of</span> <span class="n">labels</span><span class="p">:</span>  <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">345</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">393</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">349</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">357</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">341</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">315</span><span class="p">),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">343</span><span class="p">),</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">364</span><span class="p">),</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">341</span><span class="p">),</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">347</span><span class="p">)]</span>
<span class="o">--------------------------------------------------</span>
<span class="n">Client</span> <span class="mi">5</span>	 <span class="n">Size</span> <span class="n">of</span> <span class="n">data</span><span class="p">:</span> <span class="mi">3495</span>	 <span class="n">Labels</span><span class="p">:</span>  <span class="p">[</span><span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">]</span>
		 <span class="n">Samples</span> <span class="n">of</span> <span class="n">labels</span><span class="p">:</span>  <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">345</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">393</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">349</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">357</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">341</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">315</span><span class="p">),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">343</span><span class="p">),</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">364</span><span class="p">),</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">341</span><span class="p">),</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">347</span><span class="p">)]</span>
<span class="o">--------------------------------------------------</span>
<span class="n">Client</span> <span class="mi">6</span>	 <span class="n">Size</span> <span class="n">of</span> <span class="n">data</span><span class="p">:</span> <span class="mi">3495</span>	 <span class="n">Labels</span><span class="p">:</span>  <span class="p">[</span><span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">]</span>
		 <span class="n">Samples</span> <span class="n">of</span> <span class="n">labels</span><span class="p">:</span>  <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">345</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">393</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">349</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">357</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">341</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">315</span><span class="p">),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">343</span><span class="p">),</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">364</span><span class="p">),</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">341</span><span class="p">),</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">347</span><span class="p">)]</span>
<span class="o">--------------------------------------------------</span>
<span class="n">Client</span> <span class="mi">7</span>	 <span class="n">Size</span> <span class="n">of</span> <span class="n">data</span><span class="p">:</span> <span class="mi">3495</span>	 <span class="n">Labels</span><span class="p">:</span>  <span class="p">[</span><span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">]</span>
		 <span class="n">Samples</span> <span class="n">of</span> <span class="n">labels</span><span class="p">:</span>  <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">345</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">393</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">349</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">357</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">341</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">315</span><span class="p">),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">343</span><span class="p">),</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">364</span><span class="p">),</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">341</span><span class="p">),</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">347</span><span class="p">)]</span>
<span class="o">--------------------------------------------------</span>
<span class="n">Client</span> <span class="mi">8</span>	 <span class="n">Size</span> <span class="n">of</span> <span class="n">data</span><span class="p">:</span> <span class="mi">3495</span>	 <span class="n">Labels</span><span class="p">:</span>  <span class="p">[</span><span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">]</span>
		 <span class="n">Samples</span> <span class="n">of</span> <span class="n">labels</span><span class="p">:</span>  <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">345</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">393</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">349</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">357</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">341</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">315</span><span class="p">),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">343</span><span class="p">),</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">364</span><span class="p">),</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">341</span><span class="p">),</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">347</span><span class="p">)]</span>
<span class="o">--------------------------------------------------</span>
<span class="n">Client</span> <span class="mi">9</span>	 <span class="n">Size</span> <span class="n">of</span> <span class="n">data</span><span class="p">:</span> <span class="mi">3495</span>	 <span class="n">Labels</span><span class="p">:</span>  <span class="p">[</span><span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">]</span>
		 <span class="n">Samples</span> <span class="n">of</span> <span class="n">labels</span><span class="p">:</span>  <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">345</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">393</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">349</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">357</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">341</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">315</span><span class="p">),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">343</span><span class="p">),</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">364</span><span class="p">),</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">341</span><span class="p">),</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">347</span><span class="p">)]</span>
<span class="o">--------------------------------------------------</span>
<span class="n">Client</span> <span class="mi">10</span>	 <span class="n">Size</span> <span class="n">of</span> <span class="n">data</span><span class="p">:</span> <span class="mi">3495</span>	 <span class="n">Labels</span><span class="p">:</span>  <span class="p">[</span><span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">]</span>
		 <span class="n">Samples</span> <span class="n">of</span> <span class="n">labels</span><span class="p">:</span>  <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">345</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">393</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">349</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">357</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">341</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">315</span><span class="p">),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">343</span><span class="p">),</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">364</span><span class="p">),</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">341</span><span class="p">),</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">347</span><span class="p">)]</span>
<span class="o">--------------------------------------------------</span>
<span class="n">Client</span> <span class="mi">11</span>	 <span class="n">Size</span> <span class="n">of</span> <span class="n">data</span><span class="p">:</span> <span class="mi">3495</span>	 <span class="n">Labels</span><span class="p">:</span>  <span class="p">[</span><span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">]</span>
		 <span class="n">Samples</span> <span class="n">of</span> <span class="n">labels</span><span class="p">:</span>  <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">345</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">393</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">349</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">357</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">341</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">315</span><span class="p">),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">343</span><span class="p">),</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">364</span><span class="p">),</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">341</span><span class="p">),</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">347</span><span class="p">)]</span>
<span class="o">--------------------------------------------------</span>
<span class="n">Client</span> <span class="mi">12</span>	 <span class="n">Size</span> <span class="n">of</span> <span class="n">data</span><span class="p">:</span> <span class="mi">3495</span>	 <span class="n">Labels</span><span class="p">:</span>  <span class="p">[</span><span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">]</span>
		 <span class="n">Samples</span> <span class="n">of</span> <span class="n">labels</span><span class="p">:</span>  <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">345</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">393</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">349</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">357</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">341</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">315</span><span class="p">),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">343</span><span class="p">),</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">364</span><span class="p">),</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">341</span><span class="p">),</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">347</span><span class="p">)]</span>
<span class="o">--------------------------------------------------</span>
<span class="n">Client</span> <span class="mi">13</span>	 <span class="n">Size</span> <span class="n">of</span> <span class="n">data</span><span class="p">:</span> <span class="mi">3495</span>	 <span class="n">Labels</span><span class="p">:</span>  <span class="p">[</span><span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">]</span>
		 <span class="n">Samples</span> <span class="n">of</span> <span class="n">labels</span><span class="p">:</span>  <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">345</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">393</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">349</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">357</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">341</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">315</span><span class="p">),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">343</span><span class="p">),</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">364</span><span class="p">),</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">341</span><span class="p">),</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">347</span><span class="p">)]</span>
<span class="o">--------------------------------------------------</span>
<span class="n">Client</span> <span class="mi">14</span>	 <span class="n">Size</span> <span class="n">of</span> <span class="n">data</span><span class="p">:</span> <span class="mi">3495</span>	 <span class="n">Labels</span><span class="p">:</span>  <span class="p">[</span><span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">]</span>
		 <span class="n">Samples</span> <span class="n">of</span> <span class="n">labels</span><span class="p">:</span>  <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">345</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">393</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">349</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">357</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">341</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">315</span><span class="p">),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">343</span><span class="p">),</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">364</span><span class="p">),</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">341</span><span class="p">),</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">347</span><span class="p">)]</span>
<span class="o">--------------------------------------------------</span>
<span class="n">Client</span> <span class="mi">15</span>	 <span class="n">Size</span> <span class="n">of</span> <span class="n">data</span><span class="p">:</span> <span class="mi">3495</span>	 <span class="n">Labels</span><span class="p">:</span>  <span class="p">[</span><span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">]</span>
		 <span class="n">Samples</span> <span class="n">of</span> <span class="n">labels</span><span class="p">:</span>  <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">345</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">393</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">349</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">357</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">341</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">315</span><span class="p">),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">343</span><span class="p">),</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">364</span><span class="p">),</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">341</span><span class="p">),</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">347</span><span class="p">)]</span>
<span class="o">--------------------------------------------------</span>
<span class="n">Client</span> <span class="mi">16</span>	 <span class="n">Size</span> <span class="n">of</span> <span class="n">data</span><span class="p">:</span> <span class="mi">3495</span>	 <span class="n">Labels</span><span class="p">:</span>  <span class="p">[</span><span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">]</span>
		 <span class="n">Samples</span> <span class="n">of</span> <span class="n">labels</span><span class="p">:</span>  <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">345</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">393</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">349</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">357</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">341</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">315</span><span class="p">),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">343</span><span class="p">),</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">364</span><span class="p">),</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">341</span><span class="p">),</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">347</span><span class="p">)]</span>
<span class="o">--------------------------------------------------</span>
<span class="n">Client</span> <span class="mi">17</span>	 <span class="n">Size</span> <span class="n">of</span> <span class="n">data</span><span class="p">:</span> <span class="mi">3495</span>	 <span class="n">Labels</span><span class="p">:</span>  <span class="p">[</span><span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">]</span>
		 <span class="n">Samples</span> <span class="n">of</span> <span class="n">labels</span><span class="p">:</span>  <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">345</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">393</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">349</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">357</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">341</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">315</span><span class="p">),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">343</span><span class="p">),</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">364</span><span class="p">),</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">341</span><span class="p">),</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">347</span><span class="p">)]</span>
<span class="o">--------------------------------------------------</span>
<span class="n">Client</span> <span class="mi">18</span>	 <span class="n">Size</span> <span class="n">of</span> <span class="n">data</span><span class="p">:</span> <span class="mi">3495</span>	 <span class="n">Labels</span><span class="p">:</span>  <span class="p">[</span><span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">]</span>
		 <span class="n">Samples</span> <span class="n">of</span> <span class="n">labels</span><span class="p">:</span>  <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">345</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">393</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">349</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">357</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">341</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">315</span><span class="p">),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">343</span><span class="p">),</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">364</span><span class="p">),</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">341</span><span class="p">),</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">347</span><span class="p">)]</span>
<span class="o">--------------------------------------------------</span>
<span class="n">Client</span> <span class="mi">19</span>	 <span class="n">Size</span> <span class="n">of</span> <span class="n">data</span><span class="p">:</span> <span class="mi">3595</span>	 <span class="n">Labels</span><span class="p">:</span>  <span class="p">[</span><span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">]</span>
		 <span class="n">Samples</span> <span class="n">of</span> <span class="n">labels</span><span class="p">:</span>  <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">348</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">410</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">359</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">358</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">345</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">328</span><span class="p">),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">359</span><span class="p">),</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">377</span><span class="p">),</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">346</span><span class="p">),</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">365</span><span class="p">)]</span>
<span class="o">--------------------------------------------------</span>

<span class="n">Total</span> <span class="n">number</span> <span class="n">of</span> <span class="n">samples</span><span class="p">:</span> <span class="mi">70000</span>
<span class="n">The</span> <span class="n">number</span> <span class="n">of</span> <span class="n">train</span> <span class="n">samples</span><span class="p">:</span> <span class="p">[</span><span class="mi">2621</span><span class="p">,</span> <span class="mi">2621</span><span class="p">,</span> <span class="mi">2621</span><span class="p">,</span> <span class="mi">2621</span><span class="p">,</span> <span class="mi">2621</span><span class="p">,</span> <span class="mi">2621</span><span class="p">,</span> <span class="mi">2621</span><span class="p">,</span> <span class="mi">2621</span><span class="p">,</span> <span class="mi">2621</span><span class="p">,</span> <span class="mi">2621</span><span class="p">,</span> <span class="mi">2621</span><span class="p">,</span> <span class="mi">2621</span><span class="p">,</span> <span class="mi">2621</span><span class="p">,</span> <span class="mi">2621</span><span class="p">,</span> <span class="mi">2621</span><span class="p">,</span> <span class="mi">2621</span><span class="p">,</span> <span class="mi">2621</span><span class="p">,</span> <span class="mi">2621</span><span class="p">,</span> <span class="mi">2621</span><span class="p">,</span> <span class="mi">2696</span><span class="p">]</span>
<span class="n">The</span> <span class="n">number</span> <span class="n">of</span> <span class="n">test</span> <span class="n">samples</span><span class="p">:</span> <span class="p">[</span><span class="mi">874</span><span class="p">,</span> <span class="mi">874</span><span class="p">,</span> <span class="mi">874</span><span class="p">,</span> <span class="mi">874</span><span class="p">,</span> <span class="mi">874</span><span class="p">,</span> <span class="mi">874</span><span class="p">,</span> <span class="mi">874</span><span class="p">,</span> <span class="mi">874</span><span class="p">,</span> <span class="mi">874</span><span class="p">,</span> <span class="mi">874</span><span class="p">,</span> <span class="mi">874</span><span class="p">,</span> <span class="mi">874</span><span class="p">,</span> <span class="mi">874</span><span class="p">,</span> <span class="mi">874</span><span class="p">,</span> <span class="mi">874</span><span class="p">,</span> <span class="mi">874</span><span class="p">,</span> <span class="mi">874</span><span class="p">,</span> <span class="mi">874</span><span class="p">,</span> <span class="mi">874</span><span class="p">,</span> <span class="mi">899</span><span class="p">]</span>

<span class="n">Saving</span> <span class="n">to</span> <span class="n">disk</span><span class="o">.</span>

<span class="n">Finish</span> <span class="n">generating</span> <span class="n">dataset</span><span class="o">.</span>

<span class="c1"># IID 不平衡</span>
<span class="c1"># 对于每个i，每个client分到的样本数会重新划分</span>
<span class="p">(</span><span class="n">Pdb</span><span class="p">)</span> <span class="n">p</span> <span class="n">num_samples</span>
<span class="p">[</span><span class="mi">71</span><span class="p">,</span> <span class="mi">269</span><span class="p">,</span> <span class="mi">106</span><span class="p">,</span> <span class="mi">289</span><span class="p">,</span> <span class="mi">237</span><span class="p">,</span> <span class="mi">167</span><span class="p">,</span> <span class="mi">178</span><span class="p">,</span> <span class="mi">163</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">271</span><span class="p">,</span> <span class="mi">315</span><span class="p">,</span> <span class="mi">212</span><span class="p">,</span> <span class="mi">310</span><span class="p">,</span> <span class="mi">288</span><span class="p">,</span> <span class="mi">286</span><span class="p">,</span> <span class="mi">190</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">102</span><span class="p">,</span> <span class="mi">249</span><span class="p">,</span> <span class="mi">3011</span><span class="p">]</span>
<span class="p">(</span><span class="n">Pdb</span><span class="p">)</span> <span class="n">p</span> <span class="n">num_samples</span>
<span class="p">[</span><span class="mi">280</span><span class="p">,</span> <span class="mi">391</span><span class="p">,</span> <span class="mi">125</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">46</span><span class="p">,</span> <span class="mi">358</span><span class="p">,</span> <span class="mi">356</span><span class="p">,</span> <span class="mi">61</span><span class="p">,</span> <span class="mi">352</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">355</span><span class="p">,</span> <span class="mi">248</span><span class="p">,</span> <span class="mi">303</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">154</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="mi">3854</span><span class="p">]</span>

<span class="n">Client</span> <span class="mi">0</span>         <span class="n">Size</span> <span class="n">of</span> <span class="n">data</span><span class="p">:</span> <span class="mi">1882</span>      <span class="n">Labels</span><span class="p">:</span>  <span class="p">[</span><span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">]</span>
                 <span class="n">Samples</span> <span class="n">of</span> <span class="n">labels</span><span class="p">:</span>  <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">71</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">280</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">83</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">300</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">336</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">67</span><span class="p">),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">137</span><span class="p">),</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">253</span><span class="p">),</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">111</span><span class="p">),</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">244</span><span class="p">)]</span>
<span class="o">--------------------------------------------------</span>
<span class="n">Client</span> <span class="mi">1</span>         <span class="n">Size</span> <span class="n">of</span> <span class="n">data</span><span class="p">:</span> <span class="mi">2922</span>      <span class="n">Labels</span><span class="p">:</span>  <span class="p">[</span><span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">]</span>
                 <span class="n">Samples</span> <span class="n">of</span> <span class="n">labels</span><span class="p">:</span>  <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">269</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">391</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">347</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">230</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">250</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">294</span><span class="p">),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">300</span><span class="p">),</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">267</span><span class="p">),</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">253</span><span class="p">),</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">321</span><span class="p">)]</span>
<span class="o">--------------------------------------------------</span>
<span class="n">Client</span> <span class="mi">2</span>         <span class="n">Size</span> <span class="n">of</span> <span class="n">data</span><span class="p">:</span> <span class="mi">1323</span>      <span class="n">Labels</span><span class="p">:</span>  <span class="p">[</span><span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">]</span>
                 <span class="n">Samples</span> <span class="n">of</span> <span class="n">labels</span><span class="p">:</span>  <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">106</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">125</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">37</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">161</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">185</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">88</span><span class="p">),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">216</span><span class="p">),</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">132</span><span class="p">),</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">211</span><span class="p">),</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">62</span><span class="p">)]</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="client处理">client处理</h2>
<blockquote>
<p>learning_rate_decay：收敛性分析的时候要求学习率必须衰减，不衰减的话就没办法收敛，理论上是这样，实际上不衰减也能收敛，能达到一个比较高的准确率，北大的 On the Convergence of FedAvg on Non-IID Data，<a href="https://zhuanlan.zhihu.com/p/640517716">blog</a></p>
<p>localepochs：每次聚合的时候本地训练次数</p>
<p>每个本地 epoch 内执行多通常情况下，在每个本地 epoch 中，模型会根据本地训练数据进行一次参数更新，然后进行一次模型评估。然而，当采用多个更新步骤时，模型将在同一本地 epoch 内执行多次参数更新，而不是仅执行一次。这种方法可能会提高模型的收敛速度，特别是在使用大型模型和数据集进行训练时。然而，需要注意的是，多次更新步骤可能会增加过拟合的风险，因此需要仔细权衡。个参数更新步骤。</p>
<p>join_ratio：客户端每轮参加的比例，用于衡量client dift的程度</p>
<p>eval_gap：几轮评估test一次模型</p>
<p><strong><code>copy.deepcopy</code></strong> 是用于创建对象的深度拷贝，这意味着它会递归地复制对象及其包含的所有对象，而不仅仅是复制对象本身。这样做可以确保 <strong><code>self.model</code></strong> 是 <strong><code>args.model</code></strong> 的完整和独立的副本，而不是对原始对象的引用。</p>
<p><strong><code>nn.BatchNorm2d</code></strong> 批标准化被用于加速神经网络的训练，并且有助于处理梯度消失/爆炸问题。用于在卷积神经网络的卷积层后应用批标准化。它通过规范化每个输入通道的输出，然后应用缩放和偏移，以使模型更容易训练并提高泛化能力。在使用深度学习框架构建卷积神经网络时，批标准化通常被认为是一种标准的正则化技术，并且已被证明在许多情况下能够提高模型的性能和训练速度。</p>
<hr>
<p>准确率和<a href="https://zhuanlan.zhihu.com/p/569006692">AUC</a>是两个不同的指标，用于评估分类模型的性能，它们分别从整体准确性和类别排序能力的角度来衡量模型的表现。ROC 曲线下面积（ROC AUC）是一种用于衡量分类模型性能的指标，它表示分类模型在不同阈值下真正例率（True Positive Rate）与假正例率（False Positive Rate）之间的权衡。ROC 曲线是以真正例率为纵轴，假正例率为横轴所绘制的曲线，ROC AUC 则是 ROC 曲线下方的面积，取值范围在 0 到 1 之间。ROC AUC 值越接近 1，表示模型性能越好；越接近 0.5，表示模型性能越一般；小于 0.5，则表示模型性能不如随机猜测。ROC 曲线和 ROC AUC 可以帮助我们评估分类模型在不同阈值下的整体性能和稳定性。</p>
<p>AUC（Area Under the Curve）和准确率是两种不同的性能评估指标：</p>
<ol>
<li>AUC（Area Under the Curve）：用于衡量分类模型在不同阈值下真正例率（True Positive Rate）与假正例率（False Positive Rate）之间的权衡。ROC 曲线下面积（ROC AUC）是对整个 ROC 曲线的一个总体性能指标，表示分类模型对正负样本的排序能力，范围在 0 到 1 之间。</li>
<li>准确率（Accuracy）：表示模型在所有预测样本中正确分类的比例，是最常见的分类模型性能指标之一。但准确率不能很好地处理样本不均衡的情况，当正负样本比例严重失衡时，准确率并不是一个很好的评价指标。</li>
</ol>
<p>总的来说，AUC 是评估分类模型排序能力的指标，而准确率是评估模型分类能力的指标。 AUC 更适用于样本不均衡的情况，而准确率则更适用于样本均衡的情况。</p>
<ul>
<li><strong>Epoch（周期）</strong> 是指整个训练数据集被送入神经网络进行了一次正向传播和反向传播的过程。一个 epoch 表示神经网络已经学习完整个训练数据集的过程。</li>
<li><strong>Batch（批次）</strong> 是指将整个训练数据集分成若干批次，每个批次包含若干个样本。在每个批次中，模型根据批次内的样本进行一次正向传播和反向传播，然后更新参数。</li>
<li>在使用时，可以将整个训练数据集划分为多个批次，每个批次包含固定数量的样本。在每个 epoch 中，神经网络会依次处理每个批次的数据，并进行参数更新。这样可以加速训练过程，减少内存占用，并且有助于模型的收敛。</li>
</ul>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="c1"># ClientAVG继承了client类</span>
<span class="c1"># 定义了clientAVG，它是 `Client` 类的子类。</span>
<span class="c1"># 该类具有一个构造函数 `__init__`，它接受 `args`、`id`、`train_samples`、`test_samples` 等参数</span>
<span class="c1"># 并通过调用 `super()` 函数来调用父类 `Client` 的构造函数，并将参数传递给父类构造函数。</span>
<span class="kn">from</span> <span class="nn">flcore.clients.clientbase</span> <span class="kn">import</span> <span class="n">Client</span>

<span class="k">class</span> <span class="nc">clientAVG</span><span class="p">(</span><span class="n">Client</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">train_samples</span><span class="p">,</span> <span class="n">test_samples</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="c1"># 调用父类的构造函数 </span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">train_samples</span><span class="p">,</span> <span class="n">test_samples</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">argparse</span>  
  
<span class="c1"># 创建 ArgumentParser 对象  </span>
<span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s1">&#39;Process some integers.&#39;</span><span class="p">)</span>  
  
<span class="c1"># 添加命令行参数  </span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;integers&#39;</span><span class="p">,</span> <span class="n">metavar</span><span class="o">=</span><span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">nargs</span><span class="o">=</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;an integer for the accumulator&#39;</span><span class="p">)</span>  
  
<span class="c1"># 解析命令行参数  </span>
<span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>  
  
<span class="c1"># 访问解析后的参数  </span>
<span class="nb">print</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">integers</span><span class="p">)</span>  

<span class="c1"># 添加参数直接add，允许用户在命令行中指定程序的行为，而不需要修改代码。</span>
<span class="c1"># 不用在函数中添加参数，再修改调用的代码</span>
<span class="c1"># 管理超参数的一种方式</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<p>client端先通过DataLoader分好batch，用batch的每个样本做梯度下降</p>
<h2 id="fadala">FadALA</h2>
<p>但由于客户机之间数据不可见，数据的统计异质性（数据非独立同分布（non-IID）和数据量不平衡现象）便成了FL 的巨大挑战之一。数据的统计异质性使得传统联邦学习方法（如FedAvg等）很难通过FL过程训练得到适用于每个客户机的单一全局模型。</p>
<p>个性化联邦学习（pFL）方法因其应对数据统计异质性的能力受到了越来越多的关注。与寻求高质量全局模型的传统FL不同，pFL方法的目标是借助联邦学习的协同计算能力为每个客户机训练适用于自身的个性化模型。现有的在服务器上聚合模型的pFL研究可以分为以下三类：</p>
<ul>
<li>（1）学习单个全局模型并对其进行微调的方法，包括Per-FedAvg和FedRep；</li>
<li>（2）学习额外个性化模型的方法，包括pFedMe和Ditto；</li>
<li>（3）通过个性化聚合（或本地聚合）学习本地模型的方法，包括FedAMP、FedPHP、FedFomo、APPLE和PartialFed。</li>
</ul>
<p>类别（1）和（2）中的pFL方法将全局模型中的所有信息用于本地初始化（指在每次迭代的局部训练之前初始化局部模型）。然而，在全局模型中，只有提高本地模型质量的信息（符合本地训练目标的客户机所需信息）才对客户机有益。全局模型的泛化能力较差是因为其中同时存在对于单一客户机来说需要和不需要的信息。</p>
<p>类别（3）中的pFL方法，通过个性化聚合捕获全局模型中每个客户机所需的信息。但是，类别（3）中的pFL方法依旧存在（a）没有考虑客户机本地训练目标（如FedAMP和FedPHP）、（b）计算代价和通讯代价较高（如FedFomo和APPLE）、（c）隐私泄露（如FedFomo和APPLE）和（d）个性化聚合与本地训练目标不匹配（如PartialFed）等问题。此外，由于这些方法对FL过程做了大量修改，它们使用的个性化聚合方法并不能被直接用于大多数现有FL方法。</p>
<p>为了从全局模型中精确地捕获客户机所需信息，且相比于FedAvg不增加每一轮迭代中的通讯代价，作者提出了一种用于联邦学习的自适应本地聚合方法（FedALA）。如图1所示，<code>FedALA在每次本地训练之前，通过自适应本地聚合（ALA）模块将全局模型与本地模型进行聚合的方式，捕获全局模型中的所需信息</code>。由于FedALA相比于FedAvg仅使用<code>ALA修改了每一轮迭代中的本地模型初始化过程</code>，而没有改动其他FL过程，因此ALA可被直接应用于大多数现有的其他FL方法，以提升它们的个性化表现。</p>
<p>自适应本地聚合（ALA）过程</p>
<p>相比于传统联邦学习中直接将下载的全局模型覆盖本地模型得到本地初始化模型的方式，FedALA通过<code>为每个参数学习本地聚合权重，进行自适应本地聚合</code>。</p>
<p>因为深度神经网络（DNN）的较低层网络相比于较高层倾向于学习相对更通用的信息，而通用信息是各个本地模型所需信息，所以全局模型中较低层网络中的大部分信息与本地模型中较低层网络所需信息一致。为了降低学习本地聚合权重所需的计算代价，作者引入一个超参数p来控制ALA的作用范围，使得全局模型中<code>较低层网络参数直接覆盖本地模型中的较低层网络，而只在较高层启用ALA</code>。</p>

    </div>

    <div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">Author</span>
    <span class="item-content">kong</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">LastMod</span>
    <span class="item-content">
        2023-11-28
        
    </span>
  </p>
  
  
</div>
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/federated-learning/">Federated Learning</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/java01/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">Java概述</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/algo/">
            <span class="next-text nav-default">Algo</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
      <a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&amp;email=_JOXlp_emZaBjZ3IwcrMuImJ1puXlQ" class="iconfont icon-email" title="email"></a>
      <a href="https://github.com/kongfany" class="iconfont icon-github" title="github"></a>
      <a href="https://weibo.com/u/5947688533?is_all=1" class="iconfont icon-weibo" title="weibo"></a>
      <a href="https://www.zhihu.com/people/yu-ni-zhong-nian-bu-yu" class="iconfont icon-zhihu" title="zhihu"></a>
      <a href="https://space.bilibili.com/232669848" class="iconfont icon-bilibili" title="bilibili"></a>
  <a href="https://kongfany.github.io/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2017 - 
    2023<span class="heart"><i class="iconfont icon-heart"></i></span><span>kong</span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.c99b103c33d1539acf3025e1913697534542c4a5aa5af0ccc20475ed2863603b.js"></script>
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        tags: 'ams',
        }
    };
  </script>
  <script type="text/javascript" async src="/lib/mathjax/es5/tex-mml-chtml.js"></script>








</body>
</html>
